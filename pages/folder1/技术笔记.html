<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MQTT | 首页</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="icon" href="/egg.png">
    <meta name="description" content="曾先森的后端记录">
    <link rel="preload" href="/assets/css/0.styles.0559e1a2.css" as="style"><link rel="preload" href="/assets/js/app.53968dc3.js" as="script"><link rel="preload" href="/assets/js/2.f9c1d4bc.js" as="script"><link rel="preload" href="/assets/js/10.96fa90b8.js" as="script"><link rel="prefetch" href="/assets/js/11.97ba27c5.js"><link rel="prefetch" href="/assets/js/3.91f1c807.js"><link rel="prefetch" href="/assets/js/4.bbb8263b.js"><link rel="prefetch" href="/assets/js/5.d7cf43f2.js"><link rel="prefetch" href="/assets/js/6.e80d54fa.js"><link rel="prefetch" href="/assets/js/7.8723cd86.js"><link rel="prefetch" href="/assets/js/8.c89eeea4.js"><link rel="prefetch" href="/assets/js/9.759a7a31.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0559e1a2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/egg.png" alt="首页" class="logo"> <span class="site-name can-hide">首页</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分类" class="dropdown-title"><span class="title">文章</span> <span class="arrow down"></span></button> <button type="button" aria-label="分类" class="mobile-dropdown-title"><span class="title">文章</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/folder1/工作.html" class="nav-link">
  后台
</a></li><li class="dropdown-item"><!----> <a href="/pages/folder2/区块链.html" class="nav-link">
  区块链
</a></li></ul></div></div><div class="nav-item"><a href="/pages/folder1/test3.html" class="nav-link">
  功能演示
</a></div><div class="nav-item"><a href="https://github.com/zengdewei1" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分类" class="dropdown-title"><span class="title">文章</span> <span class="arrow down"></span></button> <button type="button" aria-label="分类" class="mobile-dropdown-title"><span class="title">文章</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/folder1/工作.html" class="nav-link">
  后台
</a></li><li class="dropdown-item"><!----> <a href="/pages/folder2/区块链.html" class="nav-link">
  区块链
</a></li></ul></div></div><div class="nav-item"><a href="/pages/folder1/test3.html" class="nav-link">
  功能演示
</a></div><div class="nav-item"><a href="https://github.com/zengdewei1" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>工作</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/folder1/工作.html" class="sidebar-link">面经</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>技术</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/folder1/技术笔记.html" class="active sidebar-link">技术</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#mqtt" class="sidebar-link">MQTT</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#mysql" class="sidebar-link">Mysql</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#docker-2" class="sidebar-link">Docker</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#conda" class="sidebar-link">Conda</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#gunicorn" class="sidebar-link">Gunicorn</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#uwsgi" class="sidebar-link">uWSGI</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#django" class="sidebar-link">Django</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#nginx" class="sidebar-link">Nginx</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#软技能-编程之外的升值之道" class="sidebar-link">软技能，编程之外的升值之道</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#sh" class="sidebar-link">sh</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#supervisorctl" class="sidebar-link">supervisorctl</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#redis" class="sidebar-link">Redis</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#ssh" class="sidebar-link">ssh</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#jittor" class="sidebar-link">jittor</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#pytorch" class="sidebar-link">Pytorch</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#sqlclchemy" class="sidebar-link">sqlclchemy</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#信息论" class="sidebar-link">信息论</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#devops" class="sidebar-link">Devops</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#数字图像处理" class="sidebar-link">数字图像处理</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#任务" class="sidebar-link">任务</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#操作系统" class="sidebar-link">操作系统</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#python-2" class="sidebar-link">Python</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#阿里云" class="sidebar-link">阿里云</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#kubernetes" class="sidebar-link">Kubernetes</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#docker-3" class="sidebar-link">Docker</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#bash" class="sidebar-link">bash</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#matlab" class="sidebar-link">matlab</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#alembic" class="sidebar-link">Alembic</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#latex" class="sidebar-link">latex</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#python-3" class="sidebar-link">python</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#neo4j" class="sidebar-link">neo4j</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#算法-2" class="sidebar-link">算法</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#apt" class="sidebar-link">apt</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#flask-2" class="sidebar-link">flask</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#mongo" class="sidebar-link">mongo</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#apscheduler" class="sidebar-link">apscheduler</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#提炼项目工作" class="sidebar-link">提炼项目工作</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#k8s" class="sidebar-link">k8s</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#论文" class="sidebar-link">论文</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#分享" class="sidebar-link">分享</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#web-v-2" class="sidebar-link">web-v</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#rust" class="sidebar-link">Rust</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#git-2" class="sidebar-link">git</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#不止代码" class="sidebar-link">不止代码</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#嵌入式" class="sidebar-link">嵌入式</a></li><li class="sidebar-sub-header"><a href="/pages/folder1/技术笔记.html#教程资源" class="sidebar-link">教程资源</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="mqtt"><a href="#mqtt" class="header-anchor">#</a> MQTT</h2> <p>http 请求/回答</p> <p>mqtt 发布/订阅 不需要直接建立联系</p> <p>Client</p> <p>发布应用消息给其他客户端</p> <p>订阅以请求接收消息</p> <p>Server</p> <p>云平台</p> <p>客户端间的中介</p> <h5 id="git教程"><a href="#git教程" class="header-anchor">#</a> git教程</h5> <p><a href="https://www.yiibai.com/git/git_remote.html" target="_blank" rel="noopener noreferrer">https://www.yiibai.com/git/git_remote.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h4 id="跳板"><a href="#跳板" class="header-anchor">#</a> 跳板</h4> <h5 id="带shhd的alpine"><a href="#带shhd的alpine" class="header-anchor">#</a> 带shhd的alpine</h5> <div class="language- line-numbers-mode"><pre class="language-text"><code>FROM alpine:3.10
MAINTAINER alpine:sshd (649781645@qq.com)
RUN cp -a /etc/apk/repositories /etc/apk/repositories.bak &amp;&amp; \
echo 'http://mirrors.aliyun.com/alpine/latest-stable/main/' &gt; /etc/apk/repositories &amp;&amp; \
echo 'http://mirrors.aliyun.com/alpine/latest-stable/community/' &gt;&gt; /etc/apk/repositories
RUN sed -i 's/\\h:\\w\\$ /[\\u@\\h \\W]\\$ /g' /etc/profile &amp;&amp; \
echo '' &gt; /etc/motd
RUN apk update &amp;&amp; \
apk add --no-cache openssh tzdata bash &amp;&amp; \
cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime &amp;&amp; \
sed -i &quot;s/#PermitRootLogin.*/PermitRootLogin yes/g&quot; /etc/ssh/sshd_config &amp;&amp; \
sed -i 's?/root:/bin/ash?/root:/bin/bash?g' /etc/passwd &amp;&amp; \
ssh-keygen -t dsa -P &quot;&quot; -f /etc/ssh/ssh_host_dsa_key &amp;&amp; \
ssh-keygen -t rsa -P &quot;&quot; -f /etc/ssh/ssh_host_rsa_key &amp;&amp; \
ssh-keygen -t ecdsa -P &quot;&quot; -f /etc/ssh/ssh_host_ecdsa_key &amp;&amp; \
ssh-keygen -t ed25519 -P &quot;&quot; -f /etc/ssh/ssh_host_ed25519_key &amp;&amp; \
echo &quot;root:123456&quot; | chpasswd
EXPOSE 22
CMD [&quot;/usr/sbin/sshd&quot;, &quot;-D&quot;]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>docker build -t alpine:sshd <span class="token builtin class-name">.</span>
docker run -d -p <span class="token number">2222</span>:22 alpine:sshd
<span class="token function">ssh</span> -p <span class="token number">2222</span> root@server-ip
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="markdown有趣的用法"><a href="#markdown有趣的用法" class="header-anchor">#</a> markdown有趣的用法</h4> <h5 id="文件目录的结构"><a href="#文件目录的结构" class="header-anchor">#</a> 文件目录的结构</h5> <div class="language- line-numbers-mode"><pre class="language-text"><code>tree --dirsfirst --charset=ascii /path/to/directory

|-- code
|   |-- Dockerfile
|   `-- web.go
`-- docker-compose.yaml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h5 id="结构图"><a href="#结构图" class="header-anchor">#</a> 结构图</h5> <p><a href="https://www.gracecode.com/posts/3166.html" target="_blank" rel="noopener noreferrer">https://www.gracecode.com/posts/3166.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h6 id="uml流程图-序列图-mermaid"><a href="#uml流程图-序列图-mermaid" class="header-anchor">#</a> UML流程图 序列图 mermaid</h6> <p><a href="https://www.jianshu.com/p/a9ff5a9cdb25" target="_blank" rel="noopener noreferrer">https://www.jianshu.com/p/a9ff5a9cdb25<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h6 id="js-sequence-diagrams"><a href="#js-sequence-diagrams" class="header-anchor">#</a> js-sequence-diagrams</h6> <h6 id="turns-text-into-uml-sequence-diagrams"><a href="#turns-text-into-uml-sequence-diagrams" class="header-anchor">#</a> Turns text into UML sequence diagrams</h6> <p><a href="https://bramp.github.io/js-sequence-diagrams/" target="_blank" rel="noopener noreferrer">https://bramp.github.io/js-sequence-diagrams/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h5 id="公式"><a href="#公式" class="header-anchor">#</a> 公式</h5> <p><a href="https://www.zybuluo.com/codeep/note/163962#1%E5%A6%82%E4%BD%95%E6%8F%92%E5%85%A5%E5%85%AC%E5%BC%8F" target="_blank" rel="noopener noreferrer">Cmd Markdown 公式指导手册<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h4 id="证书"><a href="#证书" class="header-anchor">#</a> 证书</h4> <h5 id="https证书pfx-生成-pem-crt-key"><a href="#https证书pfx-生成-pem-crt-key" class="header-anchor">#</a> <a href="https://www.cnblogs.com/zhaojingyu/p/11314215.html" target="_blank" rel="noopener noreferrer">https证书pfx 生成 pem,crt,key<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h5> <p>(<code>1</code>)将.pfx格式的证书转换为.pem文件格式</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>openssl pkcs12 ``-``in` `xxx.pfx ``-``nodes ``-``out server.pem
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>(<code>2</code>)从.pem文件中导出私钥server.key</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>openssl rsa ``-``in` `server.pem ``-``out server.key
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>(<code>3</code>)从.pem文件中导出证书server.crt</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>openssl x509 ``-``in` `server.pem ``-``out server.crt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h5 id="pfs"><a href="#pfs" class="header-anchor">#</a> pfs</h5> <p>一般用于 Windows 上的 IIS 服务器</p> <h5 id="ssl-证书格式普及-pem、cer、jks、pkcs12"><a href="#ssl-证书格式普及-pem、cer、jks、pkcs12" class="header-anchor">#</a> <a href="https://blog.freessl.cn/ssl-cert-format-introduce/" target="_blank" rel="noopener noreferrer">SSL 证书格式普及，PEM、CER、JKS、PKCS12<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h5> <h5 id="scp"><a href="#scp" class="header-anchor">#</a> scp</h5> <p>1、从服务器下载文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>scp username@servername:/path/filename /tmp/local_destination
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>2、上传本地文件到服务器</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>scp /path/local_filename username@servername:/path  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="git"><a href="#git" class="header-anchor">#</a> git</h4> <p>把远程分支拉到本地</p> <p>git fetch origin dev</p> <p>在本地创建分支dev并切换到该分支</p> <p><strong>git checkout -b dev(本地分支名称) origin/dev(远程分支名称)</strong></p> <h4 id="docker"><a href="#docker" class="header-anchor">#</a> Docker</h4> <p>toolbox</p> <p>vurtualbox</p> <p>起用虚拟化</p> <p>禁用hyper-V</p> <p>服务</p> <p>bcdedit /set hypervisorlaunchtype auto</p> <p>desktop</p> <p>卸载</p> <p><a href="https://docs.microsoft.com/en-us/virtualization/windowscontainers/manage-docker/configure-docker-daemon" target="_blank" rel="noopener noreferrer">Windows上的Docker引擎<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>关机或重启前关闭所有容器</p> <p>docker-engine</p> <p>网络</p> <h5 id="slat"><a href="#slat" class="header-anchor">#</a> SLAT</h5> <p>一直starting</p> <p>笔记本电脑上的电池突然耗尽，并关闭了系统</p> <p>禁用和启用Hyper-V是我的诀窍(重启Hyper-V)</p> <p><a href="https://dev.to/lasatadevi/docker-cmd-vs-entrypoint-34e0" target="_blank" rel="noopener noreferrer">Docker: cmd VS entrypoint<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>exit code 0</p> <p>您的CMD <code>Dockerfile</code>应该启动一个需要在前台运行的进程。该命令<code>service nginx start</code>以守护进程模式运行该进程，因此您的容器会干净退出，因为该<code>service</code>命令已退出。</p> <p>使用以下<code>CMD [&quot;nginx&quot;, &quot;-g&quot;, &quot;daemon off;&quot;]</code>命令启动nginx（摘自<a href="https://github.com/nginxinc/docker-nginx/blob/4e5332fa50a1f8f73657417c6bfe249bbb3b110d/Dockerfile" target="_blank" rel="noopener noreferrer">Official image<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>），它应该可以正常工作。</p> <p>windows</p> <p>docker 打开</p> <p>关闭</p> <h4 id="uwsgi服务器"><a href="#uwsgi服务器" class="header-anchor">#</a> uwsgi服务器</h4> <p><a href="https://www.jianshu.com/p/e8ee1eed2e50" target="_blank" rel="noopener noreferrer">python常用的部署方式<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>gunicorn+meinheld</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#  -*- coding: utf-8 -*-
import multiprocessing

&quot;&quot;&quot;gunicorn的配置文件&quot;&quot;&quot;

# 预加载资源
preload_app = True
# 绑定
bind = &quot;0.0.0.0:8000&quot;
# 进程数
workers = multiprocessing.cpu_count() * 2 + 1
# 线程数
threads = multiprocessing.cpu_count() * 2
# 等待队列最大长度,超过这个长度的链接将被拒绝连接
backlog = 2048
# 工作模式
worker_class = &quot;egg:meinheld#gunicorn_worker&quot;
# worker_class = &quot;gevent&quot;
# 最大客户客户端并发数量,对使用线程和协程的worker的工作有影响
worker_connections = 1000
# 进程名称
proc_name = 'gunicorn.pid'
# 进程pid记录文件
pidfile = 'app_run.log'
# 日志等级
loglevel = 'debug'
# 日志文件名
logfile = 'debug.log'
# 访问记录
accesslog = 'access.log'
# 访问记录格式
access_log_format = '%(h)s %(t)s %(U)s %(q)s'

&quot;&quot;&quot;
运行方式
命令行 gunicorn -c gunicorn_config.py flask_server:app
如果在虚拟环境下运行(双py的ubuntu之流需要虚拟环境,否则会路径混乱):
&quot;&quot;&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p><a href="https://www.khalidalnajjar.com/developing-blazing-fast-website-python-using-falcon-bjoern/" target="_blank" rel="noopener noreferrer">Falcon和Bjoern<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>import falcon
import bjoern
from pages import IndexResource
from ipaddress import ip_address

wsgi_app = api = application = falcon.API()

# -- Edit Here --
api.req_options.auto_parse_form_urlencoded = True
api.add_route('/', IndexResource()) # attach resources to API
# -- End of Edit --

if __name__ == '__main__':
	import argparse # for parsing passed parameters through terminal

	parser = argparse.ArgumentParser()
	parser.add_argument(&quot;-ip&quot;, help=&quot;Hostname&quot;, default='0.0.0.0:8000', nargs='?') # either define an IP
	parser.add_argument(&quot;-socket&quot;, help=&quot;Linux Socket Name&quot;, default=None, nargs='?') # or pass path of Linux's socket
	args = parser.parse_args()

	if args.socket: # a socket is passed
		bjoern.run(wsgi_app, 'unix:' + args.socket)
	else:
		if ':' in args.ip:
			ip, separator, port = args.ip.rpartition(':')
			ip = ip_address(ip.strip(&quot;[]&quot;))
			port = int(port)
		else:
			ip = ip_address(args.ip.strip(&quot;[]&quot;))
			port = 8000
		ip = str(ip)
		bjoern.run(wsgi_app, ip, port)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p><a href="https://www.appdynamics.com/blog/engineering/a-performance-analysis-of-python-wsgi-servers-part-2/" target="_blank" rel="noopener noreferrer">Python WSGI服务器的性能分析<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>搭建私人仓库</p> <p>线程、进程?</p> <p>烟草优化</p> <p>实时检测&gt;烟站层级按需渲染</p> <p>第一次只加载第一个station(&quot;城区工作站&quot;)第一个groups(&quot;洪林服务部&quot;)</p> <p>统计分析&gt;无法选择烤房群</p> <h3 id="web-v"><a href="#web-v" class="header-anchor">#</a> web-v</h3> <p>万能在线平台</p> <p>代码高亮</p> <p>成熟的相关网站</p> <h2 id="mysql"><a href="#mysql" class="header-anchor">#</a> Mysql</h2> <h4 id="事务"><a href="#事务" class="header-anchor">#</a> 事务</h4> <p>数据库操作语句构成事务，Innodb支持。维护完整性，保证成批的SQL语句全部执行。</p> <p>ACID 原子（undo log回滚）、一致、隔离（类似于多线程数据同步，锁机制）、持久（redo Log）</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>BEGIN
ROLLBACK
COMMIT
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="mysql-事务日志"><a href="#mysql-事务日志" class="header-anchor">#</a> <a href="http://mp.weixin.qq.com/s?__biz=MjM5MjAwODM4MA==&amp;mid=2650751455&amp;idx=3&amp;sn=d0a851a50971c92e42833cb58a9753f0&amp;chksm=bea7300c89d0b91a863db5b833c34fc3fc17447e6fd70a0ec4bb0c7d9be72696a1335f7241bd&amp;mpshare=1&amp;scene=23&amp;srcid=0916ijagqRRaCBmGn2WwI5FC&amp;sharer_sharetime=1600260862097&amp;sharer_shareid=7540eb0ab4942cf9d0ecc63b963f600f#rd" target="_blank" rel="noopener noreferrer">MySQL 事务日志<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h4> <h5 id="nosql"><a href="#nosql" class="header-anchor">#</a> NoSQL</h5> <ul><li>键值对：哈希表实现键值对</li> <li>列存储：根据数据的属性按照列进行存储，分布式系统 HBase Cassandra</li> <li>文档型：键值对，Value为结构化文档 MongoDB</li></ul> <h5 id="逻辑架构"><a href="#逻辑架构" class="header-anchor">#</a> 逻辑架构</h5> <p><img src="https://mmbiz.qpic.cn/mmbiz_png/TdGLaSU675hcsS4wOSWWZhZ2WayIL6wV95j7Yz9ATSu3lWkQIhUrGFIg8bKWGzhIKhpFW9ic2IQXqOo2OL69lmg/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="img"></p> <p>引擎层：处理事务</p> <h5 id="并发读"><a href="#并发读" class="header-anchor">#</a> 并发读</h5> <ol><li>不可重复读：事务先后读的不一致</li> <li>脏读：读到其他事务未提交</li> <li>幻读：2次读的行数不一致</li></ol> <h5 id="隔离级别"><a href="#隔离级别" class="header-anchor">#</a> 隔离级别</h5> <p>可重复读(InnoDB引擎)</p> <h5 id="mvcc"><a href="#mvcc" class="header-anchor">#</a> MVCC</h5> <p>解决多版本的并发控制协议，解决1、2，会有隐藏列：版本号、删除时间、回滚指针</p> <p>next-key lock锁定当前行以及一个范围，一种间隙锁</p> <h5 id="日志系统"><a href="#日志系统" class="header-anchor">#</a> 日志系统</h5> <h6 id="redo-log"><a href="#redo-log" class="header-anchor">#</a> redo log</h6> <p>预写式技术，更新记录写入redo log，是一种物理日志，为了crash-safe</p> <p><img src="https://mmbiz.qpic.cn/mmbiz_png/TdGLaSU675hcsS4wOSWWZhZ2WayIL6wVb3O6CSNGlMKfgRQEG5dru7VdaE3F1eSMYwSjljf8ffPzUPHU6Zzn3w/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="img"></p> <p><img src="https://mmbiz.qpic.cn/mmbiz_png/TdGLaSU675hcsS4wOSWWZhZ2WayIL6wVQoJ8UL0cuFGmur9ksdpzUvafNiaOmF1xEjea3cNPUX2sMVD8bpz5ic9Q/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="img"></p> <p>checkpoint规则：checkpoint触发后，将buffer中脏数据页(缓存池buffer pool中，内存中的数据)和脏日志页都刷到磁盘</p> <p>redo log日志可分为两个部分，一是存在易失性内存中的缓存日志redo log buff，二是保存在磁盘上的redo log日志文件redo log file，调用fsync</p> <h6 id="bin-log-归档日志"><a href="#bin-log-归档日志" class="header-anchor">#</a> bin log------归档日志</h6> <p>mysql服务层的日志，归档日志，记录数据库的变化情况，基于SQL语句，逻辑日志。</p> <p>基于时间点对数据恢复或备份</p> <p><img src="https://mmbiz.qpic.cn/mmbiz_png/TdGLaSU675hcsS4wOSWWZhZ2WayIL6wVQoV44BicNcjAPlb0gtibRVAOfuZj1Wy49yV8Q89V4FBaeibGnqiczwZCRA/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="img"></p> <p>在对redo log写入时有两个阶段的提交，一是binlog写入之前prepare状态的写入，二是binlog写入之后commit状态的写入。保证2种log一致</p> <h6 id="undo-log-回滚日志"><a href="#undo-log-回滚日志" class="header-anchor">#</a> undo log-------回滚日志</h6> <p>逻辑日志，实现MVCC</p> <h5 id="主从复制"><a href="#主从复制" class="header-anchor">#</a> 主从复制</h5> <p>通过bin log，对SQL进行复制</p> <p><img src="https://mmbiz.qpic.cn/mmbiz_png/TdGLaSU675hcsS4wOSWWZhZ2WayIL6wVXaTZGkKruLLLkqfWF87ZsnaUuru7u3evCjNVxKOcAhGxicj3m0ibwiasQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="img"></p> <p>异地备份</p> <h5 id="索引"><a href="#索引" class="header-anchor">#</a> 索引</h5> <h3 id="数据导出"><a href="#数据导出" class="header-anchor">#</a> 数据导出</h3> <h4 id="mysqldump"><a href="#mysqldump" class="header-anchor">#</a> mysqldump</h4> <h6 id="快速备份还原数据库"><a href="#快速备份还原数据库" class="header-anchor">#</a> 快速备份还原数据库</h6> <p>一系列语句直接运行就能还原数据，或者还原表结构</p> <p>部分导出某张表的数据</p> <p>mysqldump -u用户名 -p密码 数据库名 表名 --where=&quot;筛选条件&quot; &gt; 导出文件路径</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>mysqldump -uroot -p mysql user --where=&quot;user='zejin'&quot;  &gt; zejin.sql;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>产生多种格式的输出，从而使数据提取/传输更加容易</p> <p>连续导出多张表</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>mysqldump -uroot -pdbpasswd dbname test1 test2 test3&gt;db.sql;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="mysqldbexport"><a href="#mysqldbexport" class="header-anchor">#</a> <a href="https://docs.oracle.com/cd/E17952_01/mysql-utilities-1.4-en/mysqldbexport.html" target="_blank" rel="noopener noreferrer">mysqldbexport<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h4> <h4 id="如何使用索引"><a href="#如何使用索引" class="header-anchor">#</a> <a href="https://dev.mysql.com/doc/refman/8.0/en/mysql-indexes.html" target="_blank" rel="noopener noreferrer">如何使用索引<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h4> <p>索引用于快速查找具有特定列值的行。没有索引，MySQL必须从第一行开始，然后通读整个表以找到相关的行</p> <p>大多数MySQL索引（<code>PRIMARY KEY</code>， <code>UNIQUE</code>，<code>INDEX</code>和 <code>FULLTEXT</code>）存储在 <a href="https://dev.mysql.com/doc/refman/8.0/en/glossary.html#glos_b_tree" target="_blank" rel="noopener noreferrer">B树<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>这排除了对字符串列使用任何索引的可能性</p> <p>对于报表查询处理大多数或所有行的小型表或大型表，索引的重要性不那么重要。当查询需要访问大多数行时，顺序读取要比处理索引快。顺序读取可以最大程度地减少磁盘查找</p> <p>少量数据</p> <p>加索引后，查询变慢</p> <p><a href="https://dev.mysql.com/doc/refman/5.7/en/mysql-indexes.html" target="_blank" rel="noopener noreferrer">MySQL 5.7参考手册<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>迁移mysql8.0</p> <h4 id="mysql在线分表分库方案"><a href="#mysql在线分表分库方案" class="header-anchor">#</a> <a href="https://blog.csdn.net/pzqingchong/article/details/52831089" target="_blank" rel="noopener noreferrer">mysql在线分表分库方案<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h4> <p>百度钱包</p> <h5 id="不同场景下-mysql-的迁移方案"><a href="#不同场景下-mysql-的迁移方案" class="header-anchor">#</a> <a href="https://dbarobin.com/2015/09/15/migration-of-mysql-on-different-scenes/" target="_blank" rel="noopener noreferrer">不同场景下 MySQL 的迁移方案<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h5> <h3 id="外键"><a href="#外键" class="header-anchor">#</a> 外键</h3> <p>不推荐使用，不宜水平拓展</p> <h5 id="性能问题"><a href="#性能问题" class="header-anchor">#</a> 性能问题</h5> <p>用户量大，并发度高，为此数据库服务器很容易成为性能瓶颈，尤其受IO能力限制</p> <p>有了外键，当做一些涉及外键字段的增，删，更新操作之后，需要触发相关操作去检查，而不得不消耗资源</p> <p>使用外键与否，看你使用的框架是否有足够的事务管理能力。
（其实不仅限于外键，还有一切可被替代的 db 高级特性）</p> <p>因为如果是按照范式去设计，一个查询往往要进行连表查询，联表查询往往很消耗性能，适当的进行反范式设计，添加冗余字段，一个查询关联一张表就可以了，速度很快。当然了，插入的时候，维护记录可能就要维护多条记录</p> <h4 id="编码"><a href="#编码" class="header-anchor">#</a> 编码</h4> <p>UTF-8编码有可能是两个、三个、四个字节。Emoji表情或者某些特殊字符是4个字节，而<a href="http://lib.csdn.net/base/mysql" target="_blank" rel="noopener noreferrer">MySQL<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的utf8编码最多3个字节，所以数据插不进去</p> <h5 id="utf8mb4"><a href="#utf8mb4" class="header-anchor">#</a> utf8mb4</h5> <p>most bytes 4，用来兼容四字节的unicode</p> <p>latin1</p> <p>ISO-8859-1的别名，向下兼容ASCII</p> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>SHOW VARIABLES LIKE 'character_set_%';
SET NAMES 'utf8'; 	# 设置connection连接层上 clients results connection
alter database name character set utf8; 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>主要配置文件位置:<strong>/etc/mysql/my.cnf.<strong>数据库表文件夹</strong>:/var/lib/mysql/</strong></p> <h4 id="bug"><a href="#bug" class="header-anchor">#</a> bug</h4> <h5 id="incorrect-string-value"><a href="#incorrect-string-value" class="header-anchor">#</a> Incorrect string value</h5> <p>编码latin1-&gt;utf8</p> <h3 id="explain"><a href="#explain" class="header-anchor">#</a> explain</h3> <p>查询优化</p> <h3 id="优化"><a href="#优化" class="header-anchor">#</a> 优化</h3> <p>小表驱动大表</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>如select * from A where id in (select A_id from B)适用于A数据集大于B数据集的情况，而select * from A where exists (select 1 from B where A_id=A.id)则适用于A数据集小于B数据集的情况。注：已为A_id和A.id建立索引。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>不用使用真实的外键，比如<code>select * from A where id in (select A_id from B)</code>，A_id列不一定要真实存在，级联删除在应用层去解决</p> <p>orm框架是非常优秀的，但是在使用orm时需要注意外键和级联</p> <h2 id="docker-2"><a href="#docker-2" class="header-anchor">#</a> Docker</h2> <h3 id="底层原理"><a href="#底层原理" class="header-anchor">#</a> 底层原理</h3> <p>cgroups、namespace</p> <p><a href="https://www.infoq.cn/article/docker-kernel-knowledge-namespace-resource-isolation?utm_source=related_read_bottom&amp;utm_medium=article" target="_blank" rel="noopener noreferrer">Namespace 资源隔离<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>文件系统</li> <li>网络</li> <li>主机名</li> <li>进程通信</li> <li>用户权限</li> <li>PID</li></ul> <p><a href="https://www.infoq.cn/article/docker-kernel-knowledge-cgroups-resource-isolation/" target="_blank" rel="noopener noreferrer">cgroups 资源限制<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>资源限制</li> <li>优先级分配</li> <li>资源统计</li> <li>进程控制</li></ul> <p>限制、记录、隔离进程组使用的物理资源</p> <p>使用内核的 namespace 来做容器之间的隔离，docker 也是通过内核的 cgroups 来做容器的资源限制</p> <h5 id="分层文件系统"><a href="#分层文件系统" class="header-anchor">#</a> 分层文件系统</h5> <p>1到3层分别是1-操作系统 2-依赖的库和三方软件 3-应用的软件和配置。上层覆盖下层，写时拷贝原则</p> <h5 id="资源限制"><a href="#资源限制" class="header-anchor">#</a> 资源限制</h5> <p><code>docker stats</code> 查看当前容器内存资源使用</p> <h6 id="docker内存资源限制"><a href="#docker内存资源限制" class="header-anchor">#</a> <a href="https://jimmysong.io/docker-handbook/docs/memory_resource_limit.html" target="_blank" rel="noopener noreferrer">Docker内存资源限制<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h6> <h6 id="使用-docker-对容器资源进行限制"><a href="#使用-docker-对容器资源进行限制" class="header-anchor">#</a> 使用 docker 对容器资源进行限制</h6> <p><a href="https://cizixs.com/2017/08/04/docker-resources-limit/" target="_blank" rel="noopener noreferrer">https://cizixs.com/2017/08/04/docker-resources-limit/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h4 id="后台的改动"><a href="#后台的改动" class="header-anchor">#</a> 后台的改动</h4> <p>Nginx配置修改</p> <p>数据库添加</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker build . -t exam:demo
uwsgi --ini uwsgi.ini
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>windows访问</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>command: [&quot;gunicorn&quot;, &quot;-c&quot;, &quot;gunicorn_config.py&quot;, &quot;manage:app&quot;]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>TypeError: __call__()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>需要使用app，而不是manager</p> <h5 id="从docker容器中访问宿主机网络"><a href="#从docker容器中访问宿主机网络" class="header-anchor">#</a> <a href="https://nyan.im/posts/3981.html" target="_blank" rel="noopener noreferrer">从Docker容器中访问宿主机网络<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h5> <h6 id="docker提供的指向宿主机的dns"><a href="#docker提供的指向宿主机的dns" class="header-anchor">#</a> Docker提供的指向宿主机的DNS</h6> <div class="language- line-numbers-mode"><pre class="language-text"><code>host.docker.internal
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h6 id="使用docker0网络的默认网关地址"><a href="#使用docker0网络的默认网关地址" class="header-anchor">#</a> 使用docker0网络的默认网关地址</h6> <p>172.17.0.1</p> <h6 id="使用host模式"><a href="#使用host模式" class="header-anchor">#</a> 使用host模式</h6> <p>host网络没有与宿主机网络隔离，可能引发安全隐患或端口冲突</p> <p>经由docker0网桥而来的流量不经过宿主机的本地回环，因此需要将宿主机上的应用（MySQL，Redis等）配置为监听0.0.0.0</p> <p>yaml格式自带字符串</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>environment:
  - platform=hust_jsjxy
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><a href="http://localhost:9090/" target="_blank" rel="noopener noreferrer">http://localhost:9090/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>db.create_all()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>首先，mysqld转储名称为（'fee'，'fi'，'fo'，'fum'）的所有table3行：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>mysqldump <span class="token operator">-</span>u<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token operator">-</span>p<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token comment">--where=&quot;name in ('fee','fi','fo','fum')&quot; mydb table3 &gt; table3.sql</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>接下来，mysqldump从第一个mysqldump中获取具有匹配table3_id值的所有table2行：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>mysqldump <span class="token operator">-</span>u<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token operator">-</span>p<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token comment">--lock-all-tables --where=&quot;table3_id in (select id from table3 where name in ('fee','fi','fo','fum'))&quot; mydb table2 &gt; table2.sql</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>然后，mysqldump从第二个mysqldump中获取具有匹配table1_id值的所有table1行：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>mysqldump <span class="token operator">-</span>u<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token operator">-</span>p<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token comment">--lock-all-tables --where=&quot;id in (select table1_id from table2 where table3_id in (select id from table3 where name in ('fee','fi','fo','fum')))&quot; mydb table1 &gt; table1.sql</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><em>注意：由于第二个和第三个mysqldumps需要使用多个表，因此必须使用--lock-all-tables</em>。</p> <p>创建新数据库：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>mysqladmin <span class="token operator">-</span>u<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token operator">-</span>p<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> mysqladmin <span class="token keyword">create</span> newdb
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>最后，将三个mysqldumps加载到另一个数据库中，然后尝试在新数据库中进行联接。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>mysql <span class="token operator">-</span>u<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token operator">-</span>p<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token operator">-</span>D newdb <span class="token operator">&lt;</span> table1<span class="token punctuation">.</span><span class="token keyword">sql</span>
mysql <span class="token operator">-</span>u<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token operator">-</span>p<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token operator">-</span>D newdb <span class="token operator">&lt;</span> table2<span class="token punctuation">.</span><span class="token keyword">sql</span>
mysql <span class="token operator">-</span>u<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token operator">-</span>p<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token operator">-</span>D newdb <span class="token operator">&lt;</span> table3<span class="token punctuation">.</span><span class="token keyword">sql</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>ERROR 1227 (42000): Access denied; you need (at least one of) the SUPER privilege(s) for this operation</p> <p>全局事务标识符（GTID）是创建的唯一标识符，并且与在原始服务器（主服务器）上提交的每个事务相关联。该标识符不仅对于其起源的服务器是唯一的，而且在给定复制设置中的所有服务器之间也是唯一的。所有交易和所有GTID之间都存在一对一的映射</p> <p>输出文件</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> table1<span class="token punctuation">.</span>id<span class="token punctuation">,</span> table1<span class="token punctuation">.</span><span class="token keyword">level</span><span class="token punctuation">,</span> table2<span class="token punctuation">.</span>name<span class="token punctuation">,</span> table2<span class="token punctuation">.</span><span class="token keyword">level</span> 
       <span class="token keyword">from</span> table1 <span class="token keyword">join</span> table2 <span class="token keyword">on</span> table1<span class="token punctuation">.</span>id <span class="token operator">=</span> table2<span class="token punctuation">.</span>table1_id 
       <span class="token keyword">join</span> table3 <span class="token keyword">on</span> table3<span class="token punctuation">.</span>id <span class="token operator">=</span> table2<span class="token punctuation">.</span>table3_id
       <span class="token keyword">where</span> table3<span class="token punctuation">.</span>name <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token string">'fee'</span><span class="token punctuation">,</span> <span class="token string">'fi'</span><span class="token punctuation">,</span> <span class="token string">'fo'</span><span class="token punctuation">,</span> <span class="token string">'fum'</span><span class="token punctuation">)</span>
<span class="token keyword">INTO</span> <span class="token keyword">OUTFILE</span> <span class="token string">'/tmp/fee-fi-fo-fum.csv'</span>
<span class="token keyword">FIELDS</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">','</span> <span class="token keyword">OPTIONALLY</span> <span class="token keyword">ENCLOSED</span> <span class="token keyword">BY</span> <span class="token string">'&quot;'</span>
<span class="token keyword">LINES</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">'\n'</span>
<span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>--tables</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>delete from table1 where id not in (.....);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><a href="https://dba.stackexchange.com/questions/4654/is-it-possible-to-mysqldump-a-subset-of-a-database-required-to-reproduce-a-query" target="_blank" rel="noopener noreferrer">https://dba.stackexchange.com/questions/4654/is-it-possible-to-mysqldump-a-subset-of-a-database-required-to-reproduce-a-query<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>查看数据库</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>user information_schema;
select table_schema,sum(data_length)/1024 from tables group by table_schema;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>admin/result/mark 为空</p> <h5 id="docker容器访问宿主机的mysql"><a href="#docker容器访问宿主机的mysql" class="header-anchor">#</a> docker容器访问宿主机的MySQL</h5> <p>使用ifconfig命令可以看到，有一个docker0和eth0，在docker容器中可以通过eth0的IP地址加上端口号（3306）这样就可以连接上宿主机的MySQL了；另外，nginx可以通过docker0的IP地址加上构建容器时指定的端口号进行访问容器</p> <p>ip防火墙</p> <h4 id="前端的改动"><a href="#前端的改动" class="header-anchor">#</a> 前端的改动</h4> <p>兼容</p> <p>静态资源的获取写死</p> <h3 id="dockerfile"><a href="#dockerfile" class="header-anchor">#</a> Dockerfile</h3> <h5 id="优化-2"><a href="#优化-2" class="header-anchor">#</a> 优化</h5> <p>尽量使用缓存构建</p> <p>多阶段构建，构建和产物做分离</p> <p>kompose</p> <p>derrick容器迁移工具</p> <h3 id="备份和恢复-docker-镜像容器和数据"><a href="#备份和恢复-docker-镜像容器和数据" class="header-anchor">#</a> <a href="http://einverne.github.io/post/2018/03/docker-related-backup.html" target="_blank" rel="noopener noreferrer">备份和恢复 Docker 镜像容器和数据<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="docker-修改容器的挂载目录三种方式"><a href="#docker-修改容器的挂载目录三种方式" class="header-anchor">#</a> <a href="https://blog.csdn.net/zedelei/article/details/90208183" target="_blank" rel="noopener noreferrer">docker-修改容器的挂载目录三种方式<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>docker commit online-exam-backend_exam_hust_jsjxy_1 exam:hust_jsjxy
docker run -v <span class="token string">&quot;<span class="token environment constant">$PWD</span>/main&quot;</span>:/code/main -v <span class="token string">&quot;<span class="token environment constant">$PWD</span>/gunicorn/hust_jsjxy&quot;</span>:/code/gunicorn -v <span class="token string">&quot;<span class="token environment constant">$PWD</span>/migrations/hust_jsjxy&quot;</span>:/code/migrations exam:hust_jsjxy
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="docker-compose"><a href="#docker-compose" class="header-anchor">#</a> docker compose</h3> <p><a href="https://www.jianshu.com/p/9eb7cca07e32" target="_blank" rel="noopener noreferrer">https://www.jianshu.com/p/9eb7cca07e32<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="conda"><a href="#conda" class="header-anchor">#</a> Conda</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>conda env list
conda info --env
conda env -h
conda create -n bakeroom python=3.6
conda activate bakeroom
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="gunicorn"><a href="#gunicorn" class="header-anchor">#</a> Gunicorn</h2> <p>WSGI，即Web ServerGateway Interface</p> <p>基于pre-fork worker模式，运行时会有一个Master进程和多个Worker进程。Master是一个中控进程，实现对所有Worker的管理。同时，Master也不会关心客户端，所有的请求与响应都由Worker来完成</p> <h5 id="启动"><a href="#启动" class="header-anchor">#</a> 启动</h5> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>gunicorn -c gunicorn.conf bakeroom:wsgi	<span class="token comment"># django</span>
gunicorn -b <span class="token number">0.0</span>.0.0:8000 <span class="token comment"># bind</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="重启"><a href="#重启" class="header-anchor">#</a> 重启</h5> <div class="language- line-numbers-mode"><pre class="language-text"><code>pstree -ap|grep gunicorn
kill -HUP gunicorn
kill -9 28097
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h5 id="停止"><a href="#停止" class="header-anchor">#</a> 停止</h5> <p><a href="https://docs.gunicorn.org/en/stable/settings.html#" target="_blank" rel="noopener noreferrer">settings<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h5 id="工作模式"><a href="#工作模式" class="header-anchor">#</a> 工作模式</h5> <ol><li>同步Worker：这是最常见也是默认的工作模式。它的实现非常简单，一次只会处理一个请求。但是，它对于高并发的访问性能会比较低。</li> <li>异步Worker：其基于Greenlets库，通过Eventlet、Gevent实现。注意，使用这种工作模式需要安装对应的库。</li> <li>异步I/O Worker：目前支持gthread和gaiohttp两种类型。同时，使用gaiohttp需要安装aiohttp库</li></ol> <h5 id="worker数量"><a href="#worker数量" class="header-anchor">#</a> Worker数量</h5> <p>进程数 (2×$num_cores)+1</p> <h5 id="threads"><a href="#threads" class="header-anchor">#</a> threads</h5> <p>线程数 The number of worker threads for handling requests</p> <p>2-4 x $(NUM_CORES) 调节找到最优</p> <h4 id="meinheld"><a href="#meinheld" class="header-anchor">#</a> Meinheld</h4> <p>异步网络I/O、高性能，符合WSGI的Web服务器</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>--worker-class=&quot;egg:meinheld#gunicorn_worker&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>Using worker: egg:meinheld#gunicorn_worker
不能使用threads
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="docker模式下"><a href="#docker模式下" class="header-anchor">#</a> docker模式下</h5> <p>单线程工作</p> <h2 id="uwsgi"><a href="#uwsgi" class="header-anchor">#</a> uWSGI</h2> <h3 id="log"><a href="#log" class="header-anchor">#</a> log</h3> <p>--logto/--daemonize</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>disable-logging = true
log-4xx = true
log-5xx = true
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="django"><a href="#django" class="header-anchor">#</a> Django</h2> <h4 id="contrib-auth"><a href="#contrib-auth" class="header-anchor">#</a> contrib.auth</h4> <div class="language-python line-numbers-mode"><pre class="language-python"><code>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create_user<span class="token punctuation">(</span><span class="token punctuation">)</span>
cls<span class="token punctuation">.</span>add_to_class<span class="token punctuation">(</span><span class="token string">'objects'</span><span class="token punctuation">,</span> manager<span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Manager</span><span class="token punctuation">(</span>BaseManager<span class="token punctuation">.</span>from_queryset<span class="token punctuation">(</span>QuerySet<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#ManyToManyField用法</span>
Article<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>publications__title__startswith<span class="token operator">=</span><span class="token string">&quot;Science&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>distinct<span class="token punctuation">(</span><span class="token punctuation">)</span>
Article<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>publications__in<span class="token operator">=</span><span class="token punctuation">[</span>p1<span class="token punctuation">,</span>p2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>distinct<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">#返回QuerySet</span>
Article<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>exclude<span class="token punctuation">(</span>publications<span class="token operator">=</span>p2<span class="token punctuation">)</span>
p1<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>
a4<span class="token punctuation">.</span>publications<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>p2<span class="token punctuation">)</span>
p2<span class="token punctuation">.</span>article_set<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h5 id="django-crontab定时任务"><a href="#django-crontab定时任务" class="header-anchor">#</a> django-crontab定时任务</h5> <p><a href="https://www.zhidaow.com/post/django-crontab" target="_blank" rel="noopener noreferrer">https://www.zhidaow.com/post/django-crontab<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h5 id="migrations"><a href="#migrations" class="header-anchor">#</a> migrations</h5> <h3 id="drf"><a href="#drf" class="header-anchor">#</a> DRF</h3> <h5 id="记录-api"><a href="#记录-api" class="header-anchor">#</a> <a href="https://www.django-rest-framework.org/topics/documenting-your-api/#documenting-your-api" target="_blank" rel="noopener noreferrer">记录 API<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h5> <p><a href="https://swagger.io/tools/swagger-ui/" target="_blank" rel="noopener noreferrer">Swagger UI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and <a href="https://github.com/Rebilly/ReDoc" target="_blank" rel="noopener noreferrer">ReDoc<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h5 id="api-客户端"><a href="#api-客户端" class="header-anchor">#</a> <a href="https://www.django-rest-framework.org/topics/api-clients/#api-clients" target="_blank" rel="noopener noreferrer">API 客户端<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h5> <h2 id="nginx"><a href="#nginx" class="header-anchor">#</a> Nginx</h2> <p><a href="https://www.nginx.com/resources/wiki/start/topics/examples/full/" target="_blank" rel="noopener noreferrer">https://www.nginx.com/resources/wiki/start/topics/examples/full/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="管理"><a href="#管理" class="header-anchor">#</a> 管理</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>nginx	<span class="token comment"># 启动</span>
nginx -s reload	<span class="token comment"># 重启 signal</span>
nginx -c /etc/nginx/nginx/conf	<span class="token comment"># configuration</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="报文数据替换"><a href="#报文数据替换" class="header-anchor">#</a> 报文数据替换</h3> <p>将报文的数据中包含的绝对路径都添加统一的前缀，如/my/public，/my/api，/my/login</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>proxy_redirect / /my/;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="location"><a href="#location" class="header-anchor">#</a> location</h4> <h5 id="实践-测试方法"><a href="#实践-测试方法" class="header-anchor">#</a> 实践+测试方法</h5> <div class="language- line-numbers-mode"><pre class="language-text"><code>server {
    server_name website.com;
    location /doc {
        return 701; # 用这样的方式，可以方便的知道请求到了哪里
    }
    location ~* ^/document$ {
        return 702; # 用这样的方式，可以方便的知道请求到了哪里

    }
}

curl -I  website.com:8080/document
HTTP/1.1 702
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h5 id="修饰符"><a href="#修饰符" class="header-anchor">#</a> 修饰符</h5> <ul><li><code>=</code> 表示精确匹配。只有请求的url路径与后面的字符串完全相等时，才会命中。</li> <li><code>~</code> 表示该规则是使用正则定义的，区分大小写。</li> <li><code>~*</code> 表示该规则是使用正则定义的，不区分大小写。</li> <li><code>^~</code> 表示如果该符号后面的字符是最佳匹配，采用该规则，不再进行后续的查找</li></ul> <h5 id="配置-query-string"><a href="#配置-query-string" class="header-anchor">#</a> <a href="https://blog.csdn.net/liuxiao723846/article/details/54925328" target="_blank" rel="noopener noreferrer">配置$Query String<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h5> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token keyword">upstream</span> other <span class="token punctuation">{</span>  
	<span class="token keyword">server</span> <span class="token number">192.168</span><span class="token number">.71</span><span class="token number">.41</span><span class="token punctuation">:</span><span class="token number">2210</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span> 
    <span class="token comment">#if ( $query_string ~* ^(.*)c=config\b|uplog\b(.*)$ ){</span>
    <span class="token keyword">if</span>   <span class="token punctuation">(</span>  <span class="token variable">$query_string</span> <span class="token operator">~</span><span class="token operator">*</span> <span class="token string">&quot;usg=0&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">proxy_pass</span>                  <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>other<span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h5 id="index指令"><a href="#index指令" class="header-anchor">#</a> index指令</h5> <p>使用索引文件会导致内部重定向，并且可以在其他位置处理请求</p> <h5 id="nginx指定文件路径有两种方式root和alias"><a href="#nginx指定文件路径有两种方式root和alias" class="header-anchor">#</a> nginx指定文件路径有两种方式root和alias</h5> <h6 id="root"><a href="#root" class="header-anchor">#</a> root</h6> <p>root路径＋location路径</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>location /i/ {
    root /data/w3;
}
The /data/w3/i/top.gif file will be sent in response to the “/i/top.gif” request
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h6 id="alias"><a href="#alias" class="header-anchor">#</a> alias</h6> <p>使用alias路径替换location路径</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>location /i/ {
    alias /data/w3/images/;
}
on request of “/i/top.gif”, the file /data/w3/images/top.gif will be sent.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><a href="https://nginx.org/en/docs/ngx_core_module.html#events" target="_blank" rel="noopener noreferrer">events<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>， <a href="https://nginx.org/en/docs/http/ngx_http_core_module.html#http" target="_blank" rel="noopener noreferrer">http<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>， <a href="https://nginx.org/en/docs/http/ngx_http_core_module.html#server" target="_blank" rel="noopener noreferrer">server<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>和 <a href="https://nginx.org/en/docs/http/ngx_http_core_module.html#location" target="_blank" rel="noopener noreferrer">location<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="软技能-编程之外的升值之道"><a href="#软技能-编程之外的升值之道" class="header-anchor">#</a> <a href="https://developer.aliyun.com/article/707256?spm=a2c6h.12873639.0.0.671ca034vHEqUK" target="_blank" rel="noopener noreferrer">软技能，编程之外的升值之道<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <p>自我营销</p> <h4 id="职场篇"><a href="#职场篇" class="header-anchor">#</a> 职场篇</h4> <h5 id="重视人际交往能力"><a href="#重视人际交往能力" class="header-anchor">#</a> 重视人际交往能力</h5> <p>如果希望人们接受你的想法，并认可其中的价值，首先最好先主动给他人相同的待遇。如果你不能保全他人的自尊，那你永远不可能赢得他的心</p> <h5 id="晋升建议"><a href="#晋升建议" class="header-anchor">#</a> 晋升建议</h5> <ol><li>承担更多的责任</li> <li>恰当的引起别人的注意</li></ol> <p>选择有用的话题，提供演讲和培训</p> <h6 id="分享每周有意思的技术点-周报"><a href="#分享每周有意思的技术点-周报" class="header-anchor">#</a> 分享每周有意思的技术点(周报)</h6> <h6 id="本周docker"><a href="#本周docker" class="header-anchor">#</a> 本周Docker</h6> <h6 id="下周mysql"><a href="#下周mysql" class="header-anchor">#</a> 下周Mysql</h6> <p>争取多发表意见</p> <ol start="3"><li>成为问题解决者</li></ol> <h6 id="帮助其他组的同学解决问题"><a href="#帮助其他组的同学解决问题" class="header-anchor">#</a> 帮助其他组的同学解决问题</h6> <p>在项目组、团队中实践</p> <h4 id="自我营销篇"><a href="#自我营销篇" class="header-anchor">#</a> 自我营销篇</h4> <h5 id="个人网站-博客"><a href="#个人网站-博客" class="header-anchor">#</a> 个人网站-博客</h5> <p>每周一篇</p> <p>个人公众号</p> <p>技术会议</p> <h4 id="学习篇"><a href="#学习篇" class="header-anchor">#</a> 学习篇</h4> <h5 id="掌握技术的三个要点"><a href="#掌握技术的三个要点" class="header-anchor">#</a> 掌握技术的三个要点</h5> <ol><li>如何开始--前置条件，自己不知道什么</li></ol> <p>函数、局域池、schema，基本概念</p> <ol start="2"><li>学科范围--先轮廓、后细节</li> <li>基础知识--二八原理，20%的核心知识满足80%的应用</li></ol> <h5 id="_10步学习法"><a href="#_10步学习法" class="header-anchor">#</a> 10步学习法</h5> <p>1了解全局</p> <p>Mysql，多用户且健壮的SQL（结构化查询语言）数据库服务器</p> <h5 id="多线程"><a href="#多线程" class="header-anchor">#</a> 多线程</h5> <p>可使用多个CPU</p> <p><strong>关系型</strong></p> <p>结构化查询语言SQL</p> <p>支持标准SQL和ODBC(Open Database Connectivity，开放数据库互连)语法</p> <p>用C和C ++编写</p> <p>提供事务性和非事务性存储引擎</p> <p>使用<code>MyISAM</code>索引压缩非常快的B树磁盘表</p> <p>命令行程序（例如 <a href="https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html" target="_blank" rel="noopener noreferrer"><strong>mysqldump</strong><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>和 <a href="https://dev.mysql.com/doc/refman/8.0/en/mysqladmin.html" target="_blank" rel="noopener noreferrer"><strong>mysqladmin</strong><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>）以及图形程序（例如 <a href="https://dev.mysql.com/doc/refman/8.0/en/workbench.html" target="_blank" rel="noopener noreferrer">MySQL Workbench）<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>2确定范围</p> <p>优化</p> <p>3定义目标</p> <p>4寻找资源</p> <h3 id="华科论道"><a href="#华科论道" class="header-anchor">#</a> 华科论道</h3> <h5 id="新基建"><a href="#新基建" class="header-anchor">#</a> 新基建</h5> <p>ABCDE</p> <h5 id="ai"><a href="#ai" class="header-anchor">#</a> AI</h5> <p>医疗公司</p> <p>先搭建远程会诊系统，收集</p> <p>AI的难度在于如何收集数据</p> <h5 id="block-chain区块链"><a href="#block-chain区块链" class="header-anchor">#</a> Block chain区块链</h5> <p>facebook libra 联盟币</p> <p>区别于比特币</p> <p>基因数据的保密，匿名提供，充分保护个人信息</p> <p>金融等保护性强的领域</p> <p>性能的局限性</p> <h5 id="cloud"><a href="#cloud" class="header-anchor">#</a> Cloud</h5> <p>从集装箱到Docker</p> <p>云计算可以分为三层，一层的基础设施主要包括网络系统（networking）、存储设备（storage）、服务器（servers）、虚拟化技术（virtualization）。而二层的平台是在基础设施之上的，还包括操作系统（OS）、中间件（middleware）以及运行库（runtime）。最后一层就是软件了，就是在平台的基础上，还添加了数据（date）与应用（application）。</p> <p>这就是云计算的三个分层，基础设施在最末端，平台处在中间，软件则处在最顶层，分别是Infrastructure-as-a-Service(IaaS)、Platform-as-a-Service(PaaS)、Software-as-a-Service(SaaS)，而别的一些“层”可以在它们之上继续添加</p> <p>公有云、私有、混合</p> <p>AWS</p> <p>规模效应</p> <h5 id="data"><a href="#data" class="header-anchor">#</a> Data</h5> <p>数字经济的石油</p> <p>勇士队，便宜的球队，好的数据分析团队</p> <p>阿里大中台</p> <h5 id="edge-computing边缘计算"><a href="#edge-computing边缘计算" class="header-anchor">#</a> Edge Computing边缘计算</h5> <p>跨时代和创新和颠覆</p> <p>实时或更快的数据分析</p> <p>减少云端网络流量</p> <p>相对于云计算</p> <p>合久必分，分久必合</p> <p>5G三大特性</p> <p>eMBB（enhanced Mobile Broadband）</p> <p>AR、VR</p> <p>大规模机器通信mMTC</p> <p>物联网</p> <p>超高可靠低时延uRLLC</p> <p>车联网、远程医疗</p> <p>SA独立组网</p> <h5 id="科技创新如何落地"><a href="#科技创新如何落地" class="header-anchor">#</a> 科技创新如何落地</h5> <p>一波三折</p> <p>对短期乐观，对长期悲观</p> <p>PPTV</p> <p>2004-2006</p> <p>流媒体直播项目外包</p> <p>2VC，活下去，积累技术</p> <p>B2B</p> <p>06-08</p> <p>PPLive</p> <p>电视台和运营商直播</p> <p>风口，前期的技术规模化，可复制化</p> <p>B2C</p> <p>09</p> <p>PPTV.com</p> <p>技术成熟和过剩的阶段</p> <p>3年前AI人才很贵，现在AI和10年前ios一样便宜</p> <h5 id="科技创业的大坑"><a href="#科技创业的大坑" class="header-anchor">#</a> 科技创业的大坑</h5> <p>发现痛点，提供解决方案，价值网络，盈利模式的设定</p> <p>手中有锤子的人，很容易把世界上的一切看成钉子</p> <p>旧瓶新酒到新瓶新酒</p> <p>PPIO</p> <p>集合全球闲置资源，为全人类服务</p> <p>BE</p> <h2 id="sh"><a href="#sh" class="header-anchor">#</a> sh</h2> <h5 id="ubuntu执行-sh文件几种方式区别"><a href="#ubuntu执行-sh文件几种方式区别" class="header-anchor">#</a> ubuntu执行.sh文件几种方式区别</h5> <p><a href="https://blog.csdn.net/u012336923/article/details/50474692" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/u012336923/article/details/50474692<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>判断文件夹存在/是否为空</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>if [ ! -d &quot;./migrations&quot; ]
if [ &quot;`ls -A /code/migrations`&quot; = &quot;&quot; ]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="supervisorctl"><a href="#supervisorctl" class="header-anchor">#</a> supervisorctl</h2> <p><a href="https://www.jianshu.com/p/0226b7c59ae2" target="_blank" rel="noopener noreferrer">https://www.jianshu.com/p/0226b7c59ae2<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h5 id="python编写的一个多进程管理工具"><a href="#python编写的一个多进程管理工具" class="header-anchor">#</a> Python编写的一个多进程管理工具</h5> <h5 id="启动-开始"><a href="#启动-开始" class="header-anchor">#</a> 启动/开始</h5> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>supervisord -c /etc/supervisord.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h5 id="重启-2"><a href="#重启-2" class="header-anchor">#</a> 重启</h5> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">service</span> supervisord restart
systemctl start supervisord.service     //启动supervisor并加载默认配置文件
systemctl <span class="token builtin class-name">enable</span> supervisord.service    //将supervisor加入开机启动项
supervisorctl status        //查看所有进程的状态
supervisorctl stop es       //停止es
supervisorctl start es      //启动es
supervisorctl restart       //重启es
supervisorctl update        //配置文件修改后使用该命令加载新的配置
supervisorctl reload        //重新启动配置中的所有程序
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="配置文件"><a href="#配置文件" class="header-anchor">#</a> 配置文件</h4> <p><a href="http://supervisord.org/configuration.html#program-x-section-settings" target="_blank" rel="noopener noreferrer">http://supervisord.org/configuration.html#program-x-section-settings<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h5 id="supervisor配置文件-etc-superviosr-supervisord-conf"><a href="#supervisor配置文件-etc-superviosr-supervisord-conf" class="header-anchor">#</a> supervisor配置文件：<code>/etc/superviosr/supervisord.conf</code></h5> <h5 id="子进程配置文件路径-etc-supervisor-conf-d"><a href="#子进程配置文件路径-etc-supervisor-conf-d" class="header-anchor">#</a> 子进程配置文件路径：<code>/etc/supervisor/conf.d/</code></h5> <div class="language-ini line-numbers-mode"><pre class="language-ini"><code><span class="token selector">[include]</span>
<span class="token constant">files</span> <span class="token attr-value"><span class="token punctuation">=</span> /etc/supervisor/*.conf</span>
<span class="token selector">[unix_http_server]</span>
<span class="token constant">file</span> <span class="token attr-value"><span class="token punctuation">=</span> /tmp/supervisor.sock</span>
<span class="token constant">pidfile</span> <span class="token attr-value"><span class="token punctuation">=</span> /tmp/supervisor.pid</span>

<span class="token selector">[program:bake-socket]</span>
<span class="token constant">command</span><span class="token attr-value"><span class="token punctuation">=</span>bash -c '/home/jestiny/www/bakeroom/socket-script.sh restart'</span>
<span class="token constant">autostart</span><span class="token attr-value"><span class="token punctuation">=</span>true</span>
<span class="token constant">autorestart</span><span class="token attr-value"><span class="token punctuation">=</span>true</span>
<span class="token constant">stderr_logfile</span><span class="token attr-value"><span class="token punctuation">=</span>/var/log/bake/jian_err.log</span>
<span class="token constant">stdout_logfile</span><span class="token attr-value"><span class="token punctuation">=</span>/var/log/bake/jian_out.log</span>
<span class="token comment">;socket-script.sh(start stop restart)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>采用socket方式管理而非端口，更加安全</p> <p>unix:///var/run/supervisor.sock no such file</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Another program is already listening on a port that one of our HTTP servers is configured to use.  Shut this program down first before starting supervisord.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h5 id="容器"><a href="#容器" class="header-anchor">#</a> 容器</h5> <p>利用Supervisor来管理容器中的多个进程</p> <h2 id="redis"><a href="#redis" class="header-anchor">#</a> Redis</h2> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>redis-cli	<span class="token comment"># 进入交互窗口</span>
<span class="token function">shutdown</span>	<span class="token comment"># 关闭</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>初始化</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>redis-server	<span class="token comment"># default conf</span>
redis-server /etc/redis/redis.conf
/usr/local/redis/bin/redis-server <span class="token number">127.0</span>.0.1:6379
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>重启</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>/etc/init.d/redis-server stop
/etc/init.d/redis-server start
/etc/init.d/redis-server restart
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h5 id="使用systemctl控制"><a href="#使用systemctl控制" class="header-anchor">#</a> 使用systemctl控制</h5> <p><a href="https://blog.csdn.net/chwshuang/article/details/68489968" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/chwshuang/article/details/68489968<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><code>/lib/systemd/system</code></p> <p>redis.service</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>systemctl status redis-server.service
systemctl daemon-reload
systemctl restart redis
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Job for redis-server.service failed because a configured resource limit was exceeded.</p> <h5 id="使用service控制"><a href="#使用service控制" class="header-anchor">#</a> 使用service控制</h5> <p><code>/etc/init.d/</code></p> <h5 id="redis支持多个数据库"><a href="#redis支持多个数据库" class="header-anchor">#</a> Redis支持多个数据库</h5> <p>使用1分区</p> <p><code>redis://127.0.0.1/1</code></p> <p>每个数据库的数据是隔离的不能共享</p> <p>多个数据库之间并不是完全隔离的，比如FLUSHALL命令可以清空一个Redis实例中所有数据库中的数据</p> <h4 id="python"><a href="#python" class="header-anchor">#</a> python</h4> <p>参考：https://www.runoob.com/w3cnote/python-redis-intro.html</p> <p>redis 提供两个类 Redis 和 StrictRedis, StrictRedis 用于实现大部分官方的命令，Redis 是 StrictRedis 的子类</p> <p>使用 connection pool 来管理对一个 redis server 的所有连接，避免每次建立、释放连接的开销</p> <h4 id="flask"><a href="#flask" class="header-anchor">#</a> flask</h4> <h2 id="ssh"><a href="#ssh" class="header-anchor">#</a> ssh</h2> <p>端口转发：隧道</p> <p><a href="https://www.zsythink.net/archives/2450" target="_blank" rel="noopener noreferrer">https://www.zsythink.net/archives/2450<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="jittor"><a href="#jittor" class="header-anchor">#</a> jittor</h2> <p>可视化权重 <a href="https://discuss.pytorch.org/t/understanding-deep-network-visualize-weights/2060" target="_blank" rel="noopener noreferrer">https://discuss.pytorch.org/t/understanding-deep-network-visualize-weights/2060<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h5 id="深度学习模型的可视化技术总结-plt-https-www-cnblogs-com-greentomlee-p-9599277-html"><a href="#深度学习模型的可视化技术总结-plt-https-www-cnblogs-com-greentomlee-p-9599277-html" class="header-anchor">#</a> <a href="https://www.cnblogs.com/greentomlee/p/9599277.html" target="_blank" rel="noopener noreferrer">深度学习模型的可视化技术总结<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> plt <a href="https://www.cnblogs.com/greentomlee/p/9599277.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/greentomlee/p/9599277.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h5> <h5 id="visdom"><a href="#visdom" class="header-anchor">#</a> <strong>visdom</strong></h5> <p><a href="https://cg.cs.tsinghua.edu.cn/jittor/" target="_blank" rel="noopener noreferrer">https://cg.cs.tsinghua.edu.cn/jittor/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>进一步理解卷积vgg <a href="https://www.bbsmax.com/A/pRdBk2YPzn/" target="_blank" rel="noopener noreferrer">https://www.bbsmax.com/A/pRdBk2YPzn/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h5 id="融合算子优化"><a href="#融合算子优化" class="header-anchor">#</a> 融合算子优化</h5> <p>eg:卷积</p> <p>这是就元算子的优化技巧，它可以将多个算子融合为一个复杂的融合算子，包括许多卷积的变化</p> <h3 id="图像处理"><a href="#图像处理" class="header-anchor">#</a> 图像处理</h3> <p>PCA</p> <p><a href="https://setosa.io/ev/principal-component-analysis/" target="_blank" rel="noopener noreferrer">https://setosa.io/ev/principal-component-analysis/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h5 id="数据增强"><a href="#数据增强" class="header-anchor">#</a> 数据增强</h5> <p>2-norm 平方的平方根 模</p> <p>在分类效果中cross效果优于其他loss</p> <p>卷积的原理</p> <p>MegEngine</p> <p>动态图 静态图</p> <p>神经网络加速 fusion</p> <p>SWIG</p> <p>感受野</p> <p>卷积核的累计扩大感受野</p> <p>优化器很重要</p> <p>BN取代dropout</p> <p>dropout使得网络比较深时</p> <p>解决梯度传不回来的问题</p> <p>adagrad 使得梯度比较稳定</p> <p>超参数搜索</p> <p>矩阵乘法的编译器</p> <p>c++层的编译优化</p> <p>reindex不全，多对一</p> <p>large margin softmax classifier</p> <p>pytorch</p> <p>编译，矩阵乘法</p> <p>元算子</p> <p>统一计算图</p> <p>cudnn</p> <p>根据历史数据，自动选择最优的卷积算法</p> <p>扩展重索引</p> <p>tensorflow</p> <p>实现组卷积</p> <h2 id="pytorch"><a href="#pytorch" class="header-anchor">#</a> Pytorch</h2> <h4 id="tensor"><a href="#tensor" class="header-anchor">#</a> Tensor</h4> <p>numpy</p> <h4 id="动态计算图dcg"><a href="#动态计算图dcg" class="header-anchor">#</a> 动态计算图DCG</h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">ssh</span> -Nf -L <span class="token number">10022</span>:192.168.0.44:10022 -p2222  public@dian.org.cn
<span class="token function">ssh</span> -p10022 root@localhost
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="课设"><a href="#课设" class="header-anchor">#</a> 课设</h3> <p>AI穿衣、换衣</p> <p>http://www.xuan6.com/m/view.php?aid=131220</p> <p>https://www.zhihu.com/question/20042084</p> <p>风格转换</p> <p>迁移学习</p> <p>CNN</p> <p>GAN</p> <h3 id="tensorflow"><a href="#tensorflow" class="header-anchor">#</a> tensorflow</h3> <p><a href="https://zhuanlan.zhihu.com/p/29841665" target="_blank" rel="noopener noreferrer">用GPU加速深度学习: Windows安装CUDA+TensorFlow教程<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>1迁移到2.1</p> <p>tf_upgrade_v2 --infile &quot;1.x的代码文件&quot; -outfile &quot;2.x的代码文件&quot;</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>tf_upgrade_v2 --infile &quot;1.x的代码文件&quot; -outfile &quot;2.x的代码文件&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>TensorFlow 支持 CUDA 10.1（TensorFlow 2.1.0 及更高版本）</p> <p>cuda 10.1</p> <p><a href="https://developer.nvidia.com/cudnn" target="_blank" rel="noopener noreferrer">cuDNN SDK<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>（7.6 及更高版本）</p> <p>scipy.misc</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>matplotlib.pyplot.imread/imsave
np.array(Image.fromarray(image).resize((IMAGE_H, IMAGE_W)))
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="图像迁移"><a href="#图像迁移" class="header-anchor">#</a> 图像迁移</h4> <h5 id="内容损失"><a href="#内容损失" class="header-anchor">#</a> 内容损失</h5> <p>$$
\sum_{i,j}(F_{ij}-P_{ij})^2
$$</p> <p>取conv4_2</p> <p>差的平方再均一化</p> <p>特征图的个数=通道数=图像的深度（初始为3）</p> <h5 id="风格损失"><a href="#风格损失" class="header-anchor">#</a> 风格损失</h5> <p>Gram 格拉姆矩阵</p> <p>v1,v2,⋯,vn是内积空间的一组向量，Gram矩阵定义为： Gij=⟨vi,vj⟩，显然其是对称矩阵</p> <p>其实对于一个XN⋅dXN⋅d（N 个样本，d 个属性）的样本矩阵而言，X⋅X′ 即为 Gram 矩阵</p> <p>如果 v1,v2,⋯,vn分别是随机向量，则 Gram 矩阵是协方差矩阵
$$
G_{ij}^l=\sum_kF_{ik}^lF_{jk}^l\
E_l=\frac{1}{4N_l^2M_l^2}\sum_{i,j}(G_{ij}^l-A_{ij}^l)^2\
StyleLoss=\sum_{l=0}^Lw_lE_l
$$</p> <h2 id="sqlclchemy"><a href="#sqlclchemy" class="header-anchor">#</a> sqlclchemy</h2> <p>大量官方和非官方文档</p> <p><a href="https://www.sqlalchemy.org/library.html" target="_blank" rel="noopener noreferrer">https://www.sqlalchemy.org/library.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://docs.sqlalchemy.org/en/13/orm/tutorial.html" target="_blank" rel="noopener noreferrer">https://docs.sqlalchemy.org/en/13/orm/tutorial.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 官方</p> <p>连接池操作，对象关系配置，持久性操作，属性突变事件和事务处理阶段内</p> <h5 id="连接池"><a href="#连接池" class="header-anchor">#</a> 连接池</h5> <p>官方：<a href="http://lib.csdn.net/base/mysql" target="_blank" rel="noopener noreferrer">数据库<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>连接池（Connection pooling）是程序启动时建立足够的数据库连接，并将这些连接组成一个连接池，由程序动态地对池中的连接进行申请，使用，释放。
个人理解：创建数据库连接是一个很耗时的操作，也容易对数据库造成安全隐患。所以，在程序初始化的时候，集中创建多个数据库连接，并把他们集中管理，供程序使用，可以保证较快的数据库读写速度，还更加安全可靠</p> <p>create_engine</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>create_engine(&quot;mysql://scott:tiger@hostname/dbname&quot;,encoding='latin1', echo=True)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>调用本身并<strong>没有</strong> 直接建立任何实际DBAPI连接</p> <p>返回值<a href="https://docs.sqlalchemy.org/en/13/core/engines.html#sqlalchemy.create_engine" target="_blank" rel="noopener noreferrer"><code>create_engine()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>是的一个实例 <a href="https://docs.sqlalchemy.org/en/13/core/connections.html#sqlalchemy.engine.Engine" target="_blank" rel="noopener noreferrer"><code>Engine</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，它表示数据库的核心接口，通过处理该数据库和所用<a href="https://docs.sqlalchemy.org/en/13/glossary.html#term-dbapi" target="_blank" rel="noopener noreferrer">DBAPI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>详细信息的方言进行改编。在这种情况下，SQLite方言将解释对Python内置 模块的指令</p> <p>The first time a method like <a href="https://docs.sqlalchemy.org/en/13/core/connections.html#sqlalchemy.engine.Engine.execute" target="_blank" rel="noopener noreferrer"><code>Engine.execute()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> or <a href="https://docs.sqlalchemy.org/en/13/core/connections.html#sqlalchemy.engine.Engine.connect" target="_blank" rel="noopener noreferrer"><code>Engine.connect()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> is called, the <a href="https://docs.sqlalchemy.org/en/13/core/connections.html#sqlalchemy.engine.Engine" target="_blank" rel="noopener noreferrer"><code>Engine</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> establishes a real <a href="https://docs.sqlalchemy.org/en/13/glossary.html#term-dbapi" target="_blank" rel="noopener noreferrer">DBAPI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> connection to the database, which is then used to emit the SQL. When using the ORM, we typically don’t use the <a href="https://docs.sqlalchemy.org/en/13/core/connections.html#sqlalchemy.engine.Engine" target="_blank" rel="noopener noreferrer"><code>Engine</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> directly once created; instead, it’s used behind the scenes by the ORM as we’ll see shortly.</p> <h5 id="sessionmaker创建会话"><a href="#sessionmaker创建会话" class="header-anchor">#</a> sessionmaker创建会话</h5> <p><a href="https://docs.sqlalchemy.org/en/13/orm/session_basics.html#session-faq-whentocreate" target="_blank" rel="noopener noreferrer">https://docs.sqlalchemy.org/en/13/orm/session_basics.html#session-faq-whentocreate<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Session = sessionmaker(bind=engine)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>我们定义了一个<a href="https://docs.sqlalchemy.org/en/13/orm/session_api.html#sqlalchemy.orm.session.Session" target="_blank" rel="noopener noreferrer"><code>Session</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>类，它将用作新<a href="https://docs.sqlalchemy.org/en/13/orm/session_api.html#sqlalchemy.orm.session.Session" target="_blank" rel="noopener noreferrer"><code>Session</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <strong>对象的工厂</strong></p> <p>，每当需要与数据库对话时，都实例化一个<a href="https://docs.sqlalchemy.org/en/13/orm/session_api.html#sqlalchemy.orm.session.Session" target="_blank" rel="noopener noreferrer"><code>Session</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>session = Session()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h5 id="声明一个映射"><a href="#声明一个映射" class="header-anchor">#</a> 声明一个映射</h5> <h2 id="信息论"><a href="#信息论" class="header-anchor">#</a> 信息论</h2> <h5 id="自信息量"><a href="#自信息量" class="header-anchor">#</a> 自信息量</h5> <p>联合自信息量</p> <h5 id="条件自信息量"><a href="#条件自信息量" class="header-anchor">#</a> 条件自信息量</h5> <p>已看了发的是0，又去看到收的符号的确是0，得到多少新信息？</p> <p>$I(v0|u0)$</p> <p>互信息量</p> <p>信源熵</p> <p>X代表信源整体的随机变量</p> <h5 id="条件熵"><a href="#条件熵" class="header-anchor">#</a> 条件熵</h5> <p>$$
H(X|Y)=-\sum_{i=1}^n\sum_{j=1}^np(a_jb_i)log_2 (a_j/b_i)
$$</p> <h5 id="联合熵"><a href="#联合熵" class="header-anchor">#</a> 联合熵</h5> <p>$$
H(XY)=H(X)+H(Y|X)=-\sum_{i=1}^n\sum_{j=1}^np(a_jb_i)log_2 (a_jb_i)
$$</p> <h5 id="互信息量"><a href="#互信息量" class="header-anchor">#</a> 互信息量</h5> <p>$$
I(a_i;b_j)=log_2\frac{p(a_i/b_i)}{p(a_i)}=log_2\frac{后验概率}{先验}<br>
可正可负
$$</p> <h5 id="平均互信息量"><a href="#平均互信息量" class="header-anchor">#</a> 平均互信息量</h5> <p>$$
I(X;Y)=H(X)-H(X|Y)=\sum_{i=1}^n\sum_{j=1}^np(a_jb_i)\frac{log_2 (a_j/b_i)}{p(a_j)}=I(Y;X)
$$</p> <h6 id="无条件熵和条件熵之差"><a href="#无条件熵和条件熵之差" class="header-anchor">#</a> 无条件熵和条件熵之差</h6> <p>F $H(v|u)$</p> <p>G 联合熵</p> <p>H后验条件熵 $H(u|v)$</p> <p>I、J $I(u;v)$</p> <p>K $I(v;u)=I(u;v)$</p> <h5 id="连续信源"><a href="#连续信源" class="header-anchor">#</a> 连续信源</h5> <p>熵
$$
H_c(X)=-\int_Rp(x)log_2p(x)dx
$$</p> <p>最大连续熵定理</p> <p>限峰值功率</p> <p>限平均功率</p> <h5 id="熵功率"><a href="#熵功率" class="header-anchor">#</a> 熵功率</h5> <p>不能看干扰的功率，要看干扰的熵</p> <p>功率为0.01的高斯分布也可能造成误差</p> <p>所以功率越大，干扰不一定越大，与噪声的熵有关</p> <h3 id="信道编码"><a href="#信道编码" class="header-anchor">#</a> 信道编码</h3> <p>信道容量C</p> <p>强对称
$$
H(Y/X)=H_{ni}\
C=max[H(Y)-H_{ni}]\
C=1-H(p)\
H(p)=-(plog_2p+\overline{p}log_2\overline{p})
$$</p> <p>一般解
$$
\beta
$$</p> <h3 id="离散无失真信源编码定理"><a href="#离散无失真信源编码定理" class="header-anchor">#</a> 离散无失真信源编码定理</h3> <p>$D_j:ai转bj的各种失真$
$$
D_{max}=min\sum_{j=1}^mp(b_j)D_j
$$
最小平均失真度$D_{min}$
$$
D_{min}=\sum_{i=1}^np(a_i)min_jd(a_i,b_j)
$$
信道转移矩阵</p> <h4 id="定长编码"><a href="#定长编码" class="header-anchor">#</a> 定长编码</h4> <p>平均每个符号的信息量/平均符号熵 $\frac {K{log_2 m}}{L}$</p> <p>码字平均长度$\overline{K}$</p> <p>有记忆</p> <p>增量：更加独立，需要的比特数更少</p> <p>预测：人工智能</p> <ol><li>线性LP获得增量序列</li> <li>对增量序列进行霍夫曼编码</li></ol> <p>卷积码，Turbo，LDPC，Polar</p> <p>信道容量$C=max_{p(a_i)R}$</p> <h3 id="信息率失真函数"><a href="#信息率失真函数" class="header-anchor">#</a> 信息率失真函数</h3> <p>互信息量的最小值，最小为0</p> <p>计算语音压缩的极限，语音可视为高斯信源，要求编码后SNR 26dB, 8kHz采样，不考虑相关，可压缩到多少？</p> <p>采样率*R(D)=信息率(bps)	34kbps,17kbps(考虑相关)</p> <p>波性编码，现在不是波性编码，语音模型编码器，参量编码器</p> <p>信息率R，平均互信息量</p> <p>信源编码</p> <p>R(D):给定信源和可容忍的失真度，信源编码所必须的最小平均互信息量，反应的是允许失真下信源的可压缩程度</p> <h3 id="香农定理"><a href="#香农定理" class="header-anchor">#</a> 香农定理</h3> <p><img src="https://wiki.mbalib.com/w/images/math/5/8/9/58960e742d849efb2ae38123002fe0c4.png" alt="C=B\log_{2}{(1+\frac{S}{N})}=B\log_{2}{(1+\frac{S}{n_o B})}"></p> <h4 id="三大定理"><a href="#三大定理" class="header-anchor">#</a> 三大定理</h4> <h5 id="可变长无失真信源编码定理"><a href="#可变长无失真信源编码定理" class="header-anchor">#</a> 可变长无失真信源编码定理</h5> <p>最优编码的存在性定理 ,该定理指出了要做到无失真信源编码 ,每个信源符号平均所需要的最少的码元数 ,同时 ,该定理指出了最优码的存在性</p> <h5 id="有噪信道编码定理"><a href="#有噪信道编码定理" class="header-anchor">#</a> 有噪信道编码定理</h5> <p>给出了信道无差错传输时码率的上界</p> <p>如果 C是一个离散无记忆信道 的信道容量 ,那么 C必是该离散无记忆信道序列的一个可达速率</p> <h5 id="保真度准则下的信源编码定理"><a href="#保真度准则下的信源编码定理" class="header-anchor">#</a> 保真度准则下的信源编码定理</h5> <p>有损信源编码定理，只要码长足够长，总可以找到一种信源编码，使编码后的信息传输率略大于率失真函数，而码的平均失真度不大于给定的允许失真度</p> <p>语音信号</p> <p>信号功率/噪声功率</p> <p>D</p> <h3 id="密码体制的安全性"><a href="#密码体制的安全性" class="header-anchor">#</a> 密码体制的安全性</h3> <p>信源编码</p> <p>明文加密得到密文</p> <p>德国密码被破解</p> <p>加密机被破解</p> <h2 id="devops"><a href="#devops" class="header-anchor">#</a> Devops</h2> <p><img src="http://www.jamesbowman.me/post/cdlandscape/ContinuousDeliveryToolLandscape-fullsize.jpeg" alt=""></p> <h2 id="数字图像处理"><a href="#数字图像处理" class="header-anchor">#</a> 数字图像处理</h2> <p>m领域</p> <p>通道</p> <p>空间滤波</p> <p>使用二阶微分进行图片锐化</p> <p>同态滤波</p> <p>低通</p> <p>高通</p> <p>查看频域图</p> <p>周期干扰</p> <h2 id="任务"><a href="#任务" class="header-anchor">#</a> 任务</h2> <table><thead><tr><th></th> <th></th> <th></th></tr></thead> <tbody><tr><td>数字图像处理</td> <td></td> <td></td></tr> <tr><td>项目</td> <td>msyql python</td> <td></td></tr> <tr><td>cv</td> <td>python</td> <td></td></tr> <tr><td>托福(听力、阅读)、GRE</td> <td>eng</td> <td></td></tr></tbody></table> <p>CS basics</p> <p>data structures algorithms operating systems database systems C++ coding</p> <h2 id="操作系统"><a href="#操作系统" class="header-anchor">#</a> 操作系统</h2> <h3 id="概率"><a href="#概率" class="header-anchor">#</a> 概率</h3> <p>管理硬件、软件资源</p> <p>处理器，存储器，IO设备，文件资源</p> <h4 id="_1并发性"><a href="#_1并发性" class="header-anchor">#</a> 1并发性</h4> <p>并行、并发</p> <h4 id="_2共享性"><a href="#_2共享性" class="header-anchor">#</a> 2共享性</h4> <p>互斥共享/同时访问</p> <h4 id="_3虚拟性"><a href="#_3虚拟性" class="header-anchor">#</a> 3虚拟性</h4> <p>时分复用</p> <p>虚拟处理器</p> <p>多道程序设计技术</p> <p>每个程序建立进程</p> <p>多个进程时分复用</p> <p>虚拟设备</p> <p>物理设备虚拟为多个逻辑设备</p> <p>每个程序占用一个逻辑设备</p> <p>空分复用</p> <p>虚拟磁盘</p> <p>物理磁盘虚拟为逻辑磁盘</p> <p>虚拟内存</p> <h4 id="_4异步性"><a href="#_4异步性" class="header-anchor">#</a> 4异步性</h4> <p>进程等待/放弃</p> <p>进程不知道何时开始，何时停止</p> <h3 id="进程管理"><a href="#进程管理" class="header-anchor">#</a> 进程管理</h3> <h4 id="进程"><a href="#进程" class="header-anchor">#</a> 进程</h4> <p>进程控制块PCB</p> <p>系统资源分配和调度的最小单位</p> <h4 id="线程"><a href="#线程" class="header-anchor">#</a> 线程</h4> <p>运行调度的最小单位</p> <p>一个进程包含多个线程</p> <p>实际运行的最小单位</p> <table><thead><tr><th></th> <th>进程</th> <th>线程</th></tr></thead> <tbody><tr><td>资源</td> <td>资源分配的基本单位</td> <td>不拥有资源</td></tr> <tr><td>调度</td> <td>独立调度的基本单位</td> <td>最小单位</td></tr> <tr><td>系统开销</td> <td>大</td> <td>小</td></tr> <tr><td>通信</td> <td>进程IPC</td> <td>读写同一进程数据通信</td></tr></tbody></table> <h3 id="五状态模型"><a href="#五状态模型" class="header-anchor">#</a> 五状态模型</h3> <p>1就绪</p> <p>就绪队列 多个就绪进程</p> <p>2执行</p> <p>3阻塞</p> <p>阻塞队列</p> <h3 id="进程同步"><a href="#进程同步" class="header-anchor">#</a> 进程同步</h3> <p>进程同步</p> <p>生产消费者模型</p> <p>临界资源</p> <p>哲学家吃饭问题</p> <ol><li>空闲让进</li> <li>忙着等待</li> <li>有限等待</li> <li>让权等待</li></ol> <p>消息队列</p> <p>共享存储</p> <p>信号量</p> <h4 id="线程同步"><a href="#线程同步" class="header-anchor">#</a> 线程同步</h4> <p>互斥量</p> <p>读写锁</p> <p>自选锁</p> <p>条件变量</p> <h3 id="作业管理-进程调度"><a href="#作业管理-进程调度" class="header-anchor">#</a> 作业管理-进程调度</h3> <p>上下文切换机制</p> <p>非抢占式的调度</p> <h5 id="算法"><a href="#算法" class="header-anchor">#</a> 算法</h5> <ul><li>先来先服务</li> <li>短进程优先</li> <li>高优先权优先</li> <li>时间片轮转调度</li></ul> <h3 id="作业管理-死锁"><a href="#作业管理-死锁" class="header-anchor">#</a> 作业管理-死锁</h3> <h5 id="产生"><a href="#产生" class="header-anchor">#</a> 产生</h5> <p>资源竞争</p> <p>调度顺序不当</p> <p>不可剥夺条件</p> <p>环路等待条件</p> <h5 id="处理"><a href="#处理" class="header-anchor">#</a> 处理</h5> <p>剥离产生条件</p> <p>银行家算法</p> <h3 id="内存分配和回收"><a href="#内存分配和回收" class="header-anchor">#</a> 内存分配和回收</h3> <h5 id="内存分配"><a href="#内存分配" class="header-anchor">#</a> 内存分配</h5> <p>动态分区</p> <p>空闲表、空闲链</p> <p>算法</p> <p>首次适应FF-&gt;循环适应 空闲表</p> <p>最佳适应BF：空闲链 从小到大 资源利用率高</p> <p>快速适应QF：每个空闲链储存一种容量的空闲区</p> <h5 id="内存回收"><a href="#内存回收" class="header-anchor">#</a> 内存回收</h5> <p>改变空闲区的地址或容量/创建新的空闲节点</p> <h3 id="段页式存储管理"><a href="#段页式存储管理" class="header-anchor">#</a> 段页式存储管理</h3> <h4 id="页式"><a href="#页式" class="header-anchor">#</a> 页式</h4> <p>容易产生内存碎片</p> <p>页表记录映射空间</p> <p>多级页表</p> <p>段式</p> <h2 id="python-2"><a href="#python-2" class="header-anchor">#</a> Python</h2> <h3 id="面向对象"><a href="#面向对象" class="header-anchor">#</a> 面向对象</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>https<span class="token punctuation">:</span><span class="token operator">//</span>www<span class="token punctuation">.</span>runoob<span class="token punctuation">.</span>com<span class="token operator">/</span>w3cnote<span class="token operator">/</span>python<span class="token operator">-</span>understanding<span class="token operator">-</span><span class="token builtin">dict</span><span class="token operator">-</span>copy<span class="token operator">-</span>shallow<span class="token operator">-</span><span class="token keyword">or</span><span class="token operator">-</span>deep<span class="token punctuation">.</span>html
<span class="token keyword">is</span><span class="token punctuation">:</span>使用<span class="token builtin">dict</span>类的__eq__方法
<span class="token comment"># 1直接赋值：其实就是对象的引用（别名）。</span>
<span class="token comment"># 2浅复制 </span>
<span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 拷贝父对象，不会拷贝对象的内部的子对象</span>
<span class="token comment"># 3深拷贝(deepcopy)： copy 模块的 deepcopy 方法，完全拷贝了父对象及其子对象。</span>
<span class="token keyword">import</span> copy
c <span class="token operator">=</span> copy<span class="token punctuation">.</span>deepcopy<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h5 id="内置类属性"><a href="#内置类属性" class="header-anchor">#</a> 内置类属性</h5> <div class="language- line-numbers-mode"><pre class="language-text"><code>__dict__ : 类的属性（包含一个字典，由类的数据属性组成）
__doc__ :类的文档字符串
__name__: 类名
__module__: 类定义所在的模块（类的全名是'__main__.className'，如果类位于一个导入模块mymod中，那么className.__module__ 等于 mymod）
__bases__ : 类的所有父类构成元素（包含了一个由所有父类组成的元组）
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h5 id="继承"><a href="#继承" class="header-anchor">#</a> 继承</h5> <h5 id="多继承"><a href="#多继承" class="header-anchor">#</a> 多继承</h5> <p>方法重写</p> <h3 id="类的私有属性"><a href="#类的私有属性" class="header-anchor">#</a> 类的私有属性</h3> <p><strong>__private_attrs</strong>：两个下划线开头，声明该属性为私有，不能在类的外部被使用或直接访问。在类内部的方法中使用时 <strong>self.__private_attrs</strong></p> <h3 id="类的私有方法"><a href="#类的私有方法" class="header-anchor">#</a> 类的私有方法</h3> <p><strong>__private_method</strong>：两个下划线开头，声明该方法为私有方法，只能在类的内部调用 ，不能在类的外部调用</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>__init__ : 构造函数，在生成对象时调用
__del__ : 析构函数，释放对象时使用
__repr__ : 打印，转换
__setitem__ : 按照索引赋值
__getitem__: 按照索引获取值
__len__: 获得长度
__cmp__: 比较运算
__call__: 函数调用
__add__: 加运算
__sub__: 减运算
__mul__: 乘运算
__truediv__: 除运算
__mod__: 求余运算
__pow__: 乘方
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>静态方法、普通方法、类方法</strong></p> <p><img src="https://www.runoob.com/wp-content/uploads/2013/12/oopxxx.png" alt=""></p> <p>inner class</p> <h2 id="阿里云"><a href="#阿里云" class="header-anchor">#</a> 阿里云</h2> <p>ACK</p> <p>ECS</p> <p>ecs.c6.large计算型</p> <p>ecs.n4共享计算型</p> <p>ENI弹性网卡</p> <h4 id="ess"><a href="#ess" class="header-anchor">#</a> ESS</h4> <p>规则、配置、活动</p> <p>定时任务</p> <p>报警任务</p> <p>事件通知</p> <h6 id="mns等等"><a href="#mns等等" class="header-anchor">#</a> MNS等等</h6> <p>MNS主题和MNS队列是阿里云消息服务（Message Service）的两种服务模型。消息服务是一种分布式消息服务，能够帮助您在分布式组件之间自由的传递数据、通知消息，构建松耦合系统</p> <h1 id="生命周期挂钩"><a href="#生命周期挂钩" class="header-anchor">#</a> 生命周期挂钩</h1> <p>RDS的连接数、读写压力等数据</p> <table><thead><tr><th>并发量</th> <th>CPU</th> <th>内存</th> <th>连接数</th> <th>流量</th> <th>IOPS</th></tr></thead> <tbody><tr><td>400</td> <td>20</td> <td>13</td> <td>80</td> <td>1.3M</td> <td>40</td></tr> <tr><td></td> <td></td> <td></td> <td></td> <td></td> <td></td></tr> <tr><td></td> <td></td> <td></td> <td></td> <td></td> <td></td></tr></tbody></table> <p>redis的连接数、读写压力等数据</p> <table><thead><tr><th>并发量</th> <th>CPU</th> <th>内存</th> <th>连接数</th> <th></th> <th></th></tr></thead> <tbody><tr><td>400</td> <td></td> <td></td> <td>72</td> <td></td> <td></td></tr> <tr><td></td> <td></td> <td></td> <td></td> <td></td> <td></td></tr> <tr><td></td> <td></td> <td></td> <td></td> <td></td> <td></td></tr></tbody></table> <p>当前配置下可加的服务器数上限</p> <h3 id="云盘-块设备"><a href="#云盘-块设备" class="header-anchor">#</a> 云盘/块设备</h3> <h4 id="linux格式化数据盘"><a href="#linux格式化数据盘" class="header-anchor">#</a> Linux格式化数据盘</h4> <p><a href="https://www.alibabacloud.com/help/zh/doc-detail/25426.htm?spm=a2c63.p38356.b99.238.60d75eb3tKI9Zl" target="_blank" rel="noopener noreferrer">https://www.alibabacloud.com/help/zh/doc-detail/25426.htm?spm=a2c63.p38356.b99.238.60d75eb3tKI9Zl<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>fdisk -l
fdisk -u /dev/vdb # 创建一个单分区数据盘
mkfs.ext4 /dev/vdb1
cp /etc/fstab /etc/fstab.bak # 备份etc/fstab文件
echo /dev/vdb1 /mnt ext4 defaults 0 0 &gt;&gt; /etc/fstab	# 写入新分区信息
mount /dev/vdb1 /mnt	# 挂载文件系统
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="kubernetes"><a href="#kubernetes" class="header-anchor">#</a> Kubernetes</h2> <h5 id="master"><a href="#master" class="header-anchor">#</a> Master</h5> <p>kube-apiserver 、 kube-controller-manager和kube-scheduler</p> <ul><li>api-server:	资源增删改查的唯一入口</li> <li>controller-manager:	资源的自动化控制中心</li> <li>kube-scheduler:	负责资源调度的进程</li></ul> <h5 id="node"><a href="#node" class="header-anchor">#</a> Node</h5> <ul><li>kubelet:	Pod对应的容器的创建、暂停等任务，与master协作</li> <li>kube-proxy:	service通信和负载均衡</li> <li>Docker Engine</li></ul> <h5 id="官网教程"><a href="#官网教程" class="header-anchor">#</a> 官网教程</h5> <p><a href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>gitbook</p> <p><a href="https://legacy.gitbook.com/book/feisky/kubernetes/details" target="_blank" rel="noopener noreferrer">https://legacy.gitbook.com/book/feisky/kubernetes/details<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h5 id="pod"><a href="#pod" class="header-anchor">#</a> Pod</h5> <p>Pause容器、业务容器</p> <h5 id="replication-controller"><a href="#replication-controller" class="header-anchor">#</a> Replication Controller</h5> <h5 id="etcd与cadvisor"><a href="#etcd与cadvisor" class="header-anchor">#</a> Etcd与Cadvisor</h5> <p>核心组件</p> <ul><li><code>kubeadm</code>：用来初始化集群的指令。</li> <li><code>kubelet</code>：在集群中的每个节点上用来启动 pod 和容器等。</li> <li><code>kubectl</code>：用来与集群通信的命令行工具</li></ul> <p>yum安装</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">cat</span> <span class="token operator">&lt;&lt;</span>EOF <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> /etc/yum.repos.d/kubernetes.repo
<span class="token punctuation">[</span>kubernetes<span class="token punctuation">]</span>
<span class="token assign-left variable">name</span><span class="token operator">=</span>Kubernetes
<span class="token assign-left variable">baseurl</span><span class="token operator">=</span>https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/
<span class="token assign-left variable">enabled</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">repo_gpgcheck</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">gpgkey</span><span class="token operator">=</span>https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg
EOF<span class="token punctuation">;</span>

<span class="token function">sudo</span> yum <span class="token function">install</span> -y kubelet kubeadm kubectl<span class="token punctuation">;</span>
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span>EOF <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> /etc/sysctl.d/99-kubernetes-cri.conf
net.bridge.bridge-nf-call-iptables  <span class="token operator">=</span> <span class="token number">1</span>
net.ipv4.ip_forward                 <span class="token operator">=</span> <span class="token number">1</span>
net.bridge.bridge-nf-call-ip6tables <span class="token operator">=</span> <span class="token number">1</span>
EOF<span class="token punctuation">;</span>
sysctl --system<span class="token punctuation">;</span>
<span class="token function">mkdir</span> /etc/systemd/system/kubelet.service.d<span class="token punctuation">;</span>
<span class="token function">touch</span> /etc/systemd/system/kubelet.service.d/10-proxy-ipvs.conf<span class="token punctuation">;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;# 启用 ipvs 相关内核模块
[Service]
ExecStartPre=-modprobe ip_vs
ExecStartPre=-modprobe ip_vs_rr
ExecStartPre=-modprobe ip_vs_wrr
ExecStartPre=-modprobe ip_vs_sh&quot;</span> <span class="token operator">&gt;</span> /etc/systemd/system/kubelet.service.d/10-proxy-ipvs.conf<span class="token punctuation">;</span>
systemctl daemon-reload<span class="token punctuation">;</span>
systemctl <span class="token builtin class-name">enable</span> kubelet.service<span class="token punctuation">;</span>
<span class="token function">cp</span> /etc/kubernetes/admin.conf ~/.kube/config<span class="token punctuation">;</span>
kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/v0.11.0/Documentation/kube-flannel.yml<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h5 id="确保-iptables-工具不使用-nftables-后端"><a href="#确保-iptables-工具不使用-nftables-后端" class="header-anchor">#</a> 确保 iptables 工具不使用 nftables 后端</h5> <p>detected &quot;cgroupfs&quot; as the Docker cgroup driver. The recommended driver is &quot;systemd&quot;. Please follow the guide at https://kubernetes.io/docs/setup/cri/</p> <ul><li><code>apiserver</code> 是整个系统的对外接口，提供RESTful方式供客户端和其他组件调用；</li> <li><code>scheduler</code> 负责对资源进行调度，分配某个pod到某节点上；</li> <li><code>controller-manager</code> 负责管理控制器，包括端点控制器（刷新服务和pod的关联信息）和复制控制器（维护某个pod的复制为配置的数值）</li></ul> <p>未部署CNI插件，CoreDNS未正常启动</p> <p>ubuntu安装</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>apt-get update &amp;&amp; apt-get install -y apt-transport-https
curl https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | apt-key add -
cat &lt;&lt;EOF | sudo tee /etc/apt/sources.list.d/kubernetes.list
deb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main
EOF
apt-get update
apt-get install -y kubelet kubeadm kubectl
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>cat &lt;&lt;EOF | sudo tee /etc/sysctl.d/99-kubernetes-cri.conf
net.bridge.bridge-nf-call-iptables  = 1
net.ipv4.ip_forward                 = 1
net.bridge.bridge-nf-call-ip6tables = 1
EOF
sysctl --system
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h5 id="配置-kubelet"><a href="#配置-kubelet" class="header-anchor">#</a> 配置 kubelet</h5> <div class="language- line-numbers-mode"><pre class="language-text"><code>cat &lt;&lt;EOF | sudo tee /etc/systemd/system/kubelet.service.d/10-proxy-ipvs.conf
# 启用 ipvs 相关内核模块
[Service]
ExecStartPre=-modprobe ip_vs
ExecStartPre=-modprobe ip_vs_rr
ExecStartPre=-modprobe ip_vs_wrr
ExecStartPre=-modprobe ip_vs_sh
EOF
systemctl daemon-reload
systemctl enable kubelet
systemctl start kubelet
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h5 id="kubeadm"><a href="#kubeadm" class="header-anchor">#</a> kubeadm</h5> <h5 id="init-config"><a href="#init-config" class="header-anchor">#</a> init config</h5> <h5 id="join-config"><a href="#join-config" class="header-anchor">#</a> join config</h5> <h5 id="kubelet"><a href="#kubelet" class="header-anchor">#</a> kubelet</h5> <p>The kubelet is unhealthy due to a misconfiguration of the node in some way (required cgroups disabled)</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>systemctl status kubelet

journalctl -xeu kubelet

docker ps -a | grep kube | grep -v pause
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>[kubelet-check] The HTTP call equal to 'curl -sSL http://localhost:10248/healthz' failed w                                                                                                ith error: Get http://localhost:10248/healthz: dial tcp 127.0.0.1:10248: connect: connecti                                                                                                on refused.</p> <p>命令</p> <p>主机恢复原状 <code>kubeadm reset</code></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubeadm init --image-repository gcr.azk8s.cn/google-containers \
      --pod-network-cidr 10.244.0.0/16 \
      --v 5 \
      --ignore-preflight-errors=all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>mkdir -p $HOME/.kube
cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
chown $(id -u):$(id -g) $HOME/.kube/config
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>加入集群</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubeadm token create –print-join-command
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>kubeadm join 39.106.149.44:6443 --token q35g87.uzz520w386cm0fv4 \
    --discovery-token-unsafe-skip-ca-verification --v=5
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>kubeadm join 172.16.207.172:6443 --token 8cyrpu.9x1c6thc7nbrr6qb \
    --discovery-token-ca-cert-hash sha256:82838b782e3d4a65abe0220823fc64d4d9e285ca0fad28edb47b1191ea4fdde7
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>插件cni网络</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>pods pending</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl describe pods mysql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>将node节点从集群中删除</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl drain ubuntu-002 --delete-local-data --force--ignore-daemonsets --kubeconfig ./admin.conf
kubectl delete node ubuntu-002 --kubeconfig admin.conf
kubeadm reset  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h5 id="master先前无法运行pod"><a href="#master先前无法运行pod" class="header-anchor">#</a> master先前无法运行pod</h5> <div class="language- line-numbers-mode"><pre class="language-text"><code>$ kubectl taint nodes --all node-role.kubernetes.io/master-

# 恢复默认值
# $ kubectl taint nodes NODE_NAME node-role.kubernetes.io/master=true:NoSchedule
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl get nodes -o yaml | egrep '\sname:|cpu:|memory:'
docker ps | grep mysql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="阿里云的ip有问题"><a href="#阿里云的ip有问题" class="header-anchor">#</a> 阿里云的ip有问题</h5> <p>显示的是内网ip eth0[网卡一]的地址，无法切换为外网ip</p> <p>设置外网网卡 eth1</p> <p>failed to get config map</p> <p>Swagger UI是一款REST API文档在线自动生成和功能测试软件</p> <h5 id="kubeadm-token-create"><a href="#kubeadm-token-create" class="header-anchor">#</a> kubeadm token create</h5> <p>Cannot validate kube-proxy config - no validator is available</p> <p>Cannot validate kubelet config - no validator is available</p> <p>User &quot;system:bootstrap:5nvmet&quot; cannot list resource &quot;pods&quot; in API group &quot;&quot; at the cluster scope'</p> <p>User &quot;system:serviceaccount:default:default&quot; cannot list resource &quot;pods&quot; in API group &quot;&quot; at the cluster scope'</p> <p>group:	bootstrappers:kubeadm:default-node-token</p> <p>Bootstrap令牌是一个简单的承载令牌，在创建新集群或将新节点加入现有集群时应使用</p> <p><a href="https://blog.51cto.com/goome/2364702" target="_blank" rel="noopener noreferrer">https://blog.51cto.com/goome/2364702<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/reference/access-authn-authz/rbac/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>令牌验证</p> <p><a href="https://kubernetes.io/docs/reference/access-authn-authz/bootstrap-tokens/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/reference/access-authn-authz/bootstrap-tokens/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl describe clusterrolebindings |grep -B 9 User &quot;system:bootstrap:5nvmet&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>令牌作为用户名进行身份验证，<code>system:bootstrap:&lt;token id&gt;</code>并且是组的成员<code>system:bootstrappers</code>。可以在令牌的秘密中</p> <h5 id="对api的访问"><a href="#对api的访问" class="header-anchor">#</a> 对API的访问</h5> <p><a href="https://kubernetes.io/docs/reference/access-authn-authz/controlling-access/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/reference/access-authn-authz/controlling-access/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><img src="https://d33wubrfki0l68.cloudfront.net/673dbafd771491a080c02c6de3fdd41b09623c90/50100/images/docs/admin/access-control-overview.svg" alt=""></p> <h5 id="认证方式"><a href="#认证方式" class="header-anchor">#</a> 认证方式</h5> <p>客户端证书、bearer token、身份验证代理或者 HTTP 基本身份验证</p> <h5 id="服务帐户的-service-account-token"><a href="#服务帐户的-service-account-token" class="header-anchor">#</a> 服务帐户的 service account token</h5> <p>如果配置了多个授权模块，Kubernetes将检查每个模块，如果有任何模块授权该请求，则该请求可以继续进行。如果所有模块均拒绝该请求，则该请求将被拒绝（HTTP状态代码403）。</p> <p>每个有效令牌都由<code>kube-system</code>名称空间中的秘密支持</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl create rolebinding bob-admin-binding --clusterrole=admin --user=bob --namespace=acme
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>当前用户和环境</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl config current-context
kubectl config view
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><em>〜/ .bashrc</em></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>exec bash	#重启bash
kubectl completion bash &gt;/etc/bash_completion.d/kubectl
echo 'alias k=kubectl' &gt;&gt;~/.bashrc
echo 'complete -F __start_kubectl k' &gt;&gt;~/.bashrc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="使用rbac授权"><a href="#使用rbac授权" class="header-anchor">#</a> 使用RBAC授权</h5> <p><a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/reference/access-authn-authz/rbac/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Role（角色）是一系列权限的集合，例如一个角色可以包含读取 Pod 的权限和列出 Pod 的权限。Role 只能用来给某个特定 namespace 中的资源作鉴权，对多 namespace 和集群级的资源或者是非资源类的 API（如 <code>/healthz</code>）使用 ClusterRole</p> <p>RoleBinding 把角色（Role 或 ClusterRole）的权限映射到用户或者用户组，从而让这些用户继承角色在 namespace 中的权限。ClusterRoleBinding 让用户继承 ClusterRole 在整个集群中的权限</p> <h5 id="serviceaccount"><a href="#serviceaccount" class="header-anchor">#</a> ServiceAccount</h5> <h5 id="group"><a href="#group" class="header-anchor">#</a> Group</h5> <h5 id="user"><a href="#user" class="header-anchor">#</a> User</h5> <h5 id="在kubernetes-pod中使用服务帐户访问api服务器"><a href="#在kubernetes-pod中使用服务帐户访问api服务器" class="header-anchor">#</a> 在Kubernetes Pod中使用服务帐户访问API服务器</h5> <p><a href="https://tonybai.com/2017/03/03/access-api-server-from-a-pod-through-serviceaccount/" target="_blank" rel="noopener noreferrer">https://tonybai.com/2017/03/03/access-api-server-from-a-pod-through-serviceaccount/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h5 id="kubernetes部署的安全配置"><a href="#kubernetes部署的安全配置" class="header-anchor">#</a> Kubernetes部署的安全配置</h5> <p><a href="https://tonybai.com/2016/11/25/the-security-settings-for-kubernetes-cluster/" target="_blank" rel="noopener noreferrer">https://tonybai.com/2016/11/25/the-security-settings-for-kubernetes-cluster/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h5 id="permissive-rbac"><a href="#permissive-rbac" class="header-anchor">#</a> Permissive RBAC</h5> <p>授权给所有的 Service Accounts 管理员权限</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl create clusterrolebinding deployment-binding \
  --clusterrole=system:controller:deployment-controller  \
  --group=system:serviceaccounts
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>新的认证方式 kubeconfig</p> <p>ca证书</p> <p>密码认证</p> <p>官网的认证方式 多尝试</p> <h5 id="使用-kubectl-代理"><a href="#使用-kubectl-代理" class="header-anchor">#</a> 使用 kubectl 代理</h5> <h5 id="从-pod-中访问-api"><a href="#从-pod-中访问-api" class="header-anchor">#</a> 从 Pod 中访问 API</h5> <p>client-go</p> <p>集群外/内身份验证</p> <p>访问集群 <a href="https://kubernetes.io/docs/tasks/access-application-cluster/access-cluster/#" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/tasks/access-application-cluster/access-cluster/#<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h5 id="headerless-service"><a href="#headerless-service" class="header-anchor">#</a> headerless service</h5> <p><a href="https://dev.to/kaoskater08/building-a-headless-service-in-kubernetes-3bk8" target="_blank" rel="noopener noreferrer">https://dev.to/kaoskater08/building-a-headless-service-in-kubernetes-3bk8<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h5 id="minikube"><a href="#minikube" class="header-anchor">#</a> minikube</h5> <p><a href="https://kubernetes.io/docs/tasks/tools/install-minikube/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/tasks/tools/install-minikube/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>在macOS，Linux和Windows上实现了本地Kubernetes集群。minikube的<a href="https://minikube.sigs.k8s.io/docs/concepts/principles/" target="_blank" rel="noopener noreferrer">主要目标<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>是成为本地Kubernetes应用程序开发的最佳工具，并支持所有合适的Kubernetes功能</p> <p>Katacoda提供了免费的浏览器内部Kubernetes环境</p> <h3 id="使用kubeadm进行证书管理"><a href="#使用kubeadm进行证书管理" class="header-anchor">#</a> 使用kubeadm进行证书管理</h3> <h3 id="kubectl"><a href="#kubectl" class="header-anchor">#</a> kubectl</h3> <p>查看更新发布历史</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl rollout history deploy gunicorn-deployment-basic
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="pod-2"><a href="#pod-2" class="header-anchor">#</a> Pod</h3> <p>resources</p> <h3 id="service"><a href="#service" class="header-anchor">#</a> Service</h3> <p>type</p> <p>ClusterIP</p> <p>虚拟IP，集群内部Pod访问</p> <p>NodePort</p> <p>宿主机端口</p> <p>LoadBalancer</p> <p>负载均衡</p> <p>Ingress7层路由</p> <h5 id="pv"><a href="#pv" class="header-anchor">#</a> PV</h5> <p>持久存储</p> <p>PersistentVolume</p> <p>PersistentVolumeClaim</p> <h5 id="定时伸缩组件kubernetes-cronhpa-controller"><a href="#定时伸缩组件kubernetes-cronhpa-controller" class="header-anchor">#</a> 定时伸缩组件kubernetes-cronhpa-controller</h5> <h2 id="docker-3"><a href="#docker-3" class="header-anchor">#</a> Docker</h2> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>docker run --name my-nginx -v /root/nginx/conf.d:/etc/nginx/conf.d -p <span class="token number">9000</span>:80 -d nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="bash"><a href="#bash" class="header-anchor">#</a> bash</h2> <p>当前工作目录</p> <p>脚本所在目录</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>echo '$0: '$0
echo &quot;pwd: &quot;`pwd`
echo &quot;=============================&quot;
echo &quot;scriptPath1: &quot;$(cd `dirname $0`; pwd)
echo &quot;scriptPath2: &quot;$(pwd)
echo &quot;scriptPath3: &quot;$(dirname $(readlink -f $0))
echo &quot;scriptPath4: &quot;$(cd $(dirname ${BASH_SOURCE:-$0});pwd)
echo -n &quot;scriptPath5: &quot; &amp;&amp; dirname $(readlink -f ${BASH_SOURCE[0]})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="matlab"><a href="#matlab" class="header-anchor">#</a> matlab</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>&amp; |
ordfilt2()%二维统计顺序滤波函数
medfilt2()%中值滤波
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="alembic"><a href="#alembic" class="header-anchor">#</a> Alembic</h2> <h2 id="latex"><a href="#latex" class="header-anchor">#</a> latex</h2> <p>TeX 发行，也叫 TeX 发行版、TeX 系统或者 TeX 套装，指的是包括 TeX 系统的各种可执行程序，以及他们执行时需要的一些辅助程序和宏包文档的集合</p> <p>TeXworks：TeX Live 自带的编辑器</p> <p>若干排版工具（pdfTeX, pdfLaTeX, XeTeX, XeLaTeX 等）</p> <p><code>CTex</code>宏集：包含若干文档类（<code>.cls</code> 文件）和宏包（<code>.sty</code> 文件），<code>CTeX</code> 套装是一个<strong>过时的</strong> TeX 系统</p> <p>pdfLaTeX默认</p> <h3 id="段落"><a href="#段落" class="header-anchor">#</a> 段落</h3> <h3 id="公式-2"><a href="#公式-2" class="header-anchor">#</a> 公式</h3> <h3 id="图片"><a href="#图片" class="header-anchor">#</a> 图片</h3> <h5 id="终极参考文献引用管理bibtex"><a href="#终极参考文献引用管理bibtex" class="header-anchor">#</a> <a href="https://www.jianshu.com/p/5aa8ea1578e6" target="_blank" rel="noopener noreferrer">终极参考文献引用管理BibTeX<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h5> <p>在a.tex其他的位置，需要有\cite{文献a}、\citet{文献a}、\citep{文献a} 等的引用格式，否则参考文献不会显示</p> <p>编译a.tex的时候，LaTex—BibTeX—LaTex—LaTex，需要编译四次</p> <h5 id="latex技巧829-使用bibtex生成参考文献列表"><a href="#latex技巧829-使用bibtex生成参考文献列表" class="header-anchor">#</a> <a href="https://www.latexstudio.net/archives/5594" target="_blank" rel="noopener noreferrer">LaTeX技巧829:使用BibTeX生成参考文献列表<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h5> <p><code>bst</code> 是 (B)ibliography (ST)yle 的缩写。顾名思义，和 <code>sty</code> 文件是 style 的缩写一样，<code>bst</code> 文件控制着参考文献列表的格式</p> <h2 id="python-3"><a href="#python-3" class="header-anchor">#</a> python</h2> <h3 id="logging"><a href="#logging" class="header-anchor">#</a> logging</h3> <p>server <a href="https://github.com/keejo125/flask_logging_demo" target="_blank" rel="noopener noreferrer">https://github.com/keejo125/flask_logging_demo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>logging <a href="https://zhuanlan.zhihu.com/p/93712428" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/93712428<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://juejin.im/post/5bc2bd3a5188255c94465d31" target="_blank" rel="noopener noreferrer">https://juejin.im/post/5bc2bd3a5188255c94465d31<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>官网 <a href="https://dormousehole.readthedocs.io/en/latest/logging.html" target="_blank" rel="noopener noreferrer">https://dormousehole.readthedocs.io/en/latest/logging.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>如果没有自己配置日志， Flask 会自动添加一个 <a href="https://docs.python.org/3/library/logging.handlers.html#logging.StreamHandler" target="_blank" rel="noopener noreferrer"><code>StreamHandler</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 到 <a href="https://dormousehole.readthedocs.io/en/latest/api.html#flask.Flask.logger" target="_blank" rel="noopener noreferrer"><code>app.logger</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>,在请求过程中，它会写到由 WSGI 服务器指定的，保存在 <code>environ['wsgi.errors']</code> 变量中的日志流（通常是 <a href="https://docs.python.org/3/library/sys.html#sys.stderr" target="_blank" rel="noopener noreferrer"><code>sys.stderr</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ） 中。在请求之外，则会记录到 <a href="https://docs.python.org/3/library/sys.html#sys.stderr" target="_blank" rel="noopener noreferrer"><code>sys.stderr</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>看到更多请求信息，如 IP 地址，有助调试某些错误。可以继承 <a href="https://docs.python.org/3/library/logging.html#logging.Formatter" target="_blank" rel="noopener noreferrer"><code>logging.Formatter</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 来注入自己的内容，以显示在日志消息中。然后，可 以修改 Flask 缺省的日志记录器、上文所述的电子邮件日志记录器或者其他日志记 录器的格式器。</p> <p><strong>dictConfig</strong>：从字典中获取日志记录配置</p> <p>flask <a href="https://www.flyml.net/2018/12/12/flask-logging-usage-demo/" target="_blank" rel="noopener noreferrer">https://www.flyml.net/2018/12/12/flask-logging-usage-demo/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>gunicorn + flask</p> <p><code>stdout</code>会收集的是print到console的信息</p> <p>Gunicorn的配置文件中只有<code>access.file</code> <code>stderr.file</code>以及<code>sysout.file</code>三种输出文件地址的配置。其中<code>access.file</code>会显示调用API的程序的网络地址，<code>sysout.file</code>具体功能不详，但是貌似是非常底层的东西，其余的log信息都会进入<code>stderr.file</code></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>heapq`将使用运算符的任何东西，你投入它。`&lt;=
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h5 id="tuple比较"><a href="#tuple比较" class="header-anchor">#</a> tuple比较</h5> <p>元组按位置进行比较：第一元组的第一项与第二元组的第一项进行比较;如果它们不相等（即第一个大于或小于第二个），则这是比较的结果，否则将考虑第二个项目，然后考虑第三个项，等等</p> <p>您可以将对象的 ID 添加到元组，以便您的元组变为：</p> <div class="language-py line-numbers-mode"><pre class="language-py"><code><span class="token punctuation">(</span>priority<span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">,</span> obj<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>因为对象 ID 是唯一的。（请注意：如果添加具有相同优先级的同一对象的两个实例，则再次遇到此问题）。</p> <h4 id="import"><a href="#import" class="header-anchor">#</a> import</h4> <h5 id="module"><a href="#module" class="header-anchor">#</a> module</h5> <p>一个.py文件就是一个module，即“模块”，<strong>模块的名称是文件名去掉末尾的'.py'</strong></p> <p>有的模块出于运行效率考虑，是被编译进Python解释器的，并不以<code>.py</code>文件形式存在，比如常用的<code>builtins</code>、<code>sys</code>等。内置的<code>len()</code>函数、加减乘除运算等就在<code>builtins</code>模块中，使用时甚至不需要我们import，Python解释器在启动时便已import好了，而<code>sys</code>模块需要先import才能使用</p> <h5 id="package"><a href="#package" class="header-anchor">#</a> package</h5> <p>包是一个特殊的目录，其下<strong>必须</strong>含有名为<code>__init__.py</code>的文件</p> <h5 id="relative-import和absolute-import"><a href="#relative-import和absolute-import" class="header-anchor">#</a> relative import和absolute import</h5> <p>相对导入方式可以解决导入当前目录、上级目录、上上级目录下模块的需求，但<strong>使用相对导入的文件不能直接以脚本方式运行，只能以模块方式（-m选项）运行，并且当前路径要处于import语句定位的路径或更高层路径</strong></p> <p><strong>绝对导入的方式无法导入上级目录的模块</strong></p> <p>尽可能地减少在import语句使用 &quot;<em>&quot; 符号，实在无法避免时，为限制 &quot;</em>&quot; 符号带来的命名冲突，在<code>construct/__init__.py</code>、<code>decoration/__init__.py</code>文件中，定义<code>__all__</code>变量，明确限定允许被导出的所有符号</p> <h4 id="os"><a href="#os" class="header-anchor">#</a> os</h4> <p><code>os.path.abspath(__file__)</code></p> <h2 id="neo4j"><a href="#neo4j" class="header-anchor">#</a> neo4j</h2> <p>社会型数据，在处理大数据方面的优势,近年来图数据库的几个典型应用场景：知识图谱、金融风控、社交关系等场景</p> <p>优势</p> <p>可以很高效的插入大量数据</p> <p>图数据库基本能胜任亿级以上的数据</p> <p>高效的查询关联数据</p> <p>传统关系型数据库不擅长做关联查询，特别是多层关联（比如查我的好友的好友有哪些人），因为一般来说都需要做表连接，表连接是一个很昂贵的操作，涉及到大量的IO操作及内存消耗。图数据库对关联查询一般都进行针对性的优化，比如存储模型上、数据结构、查询算法等，防止局部数据的查询引发全部数据的读取</p> <p>Cypher等图数据库语言，图查询语言大大方便了关联分析业务的持续开发，传统方案在需求变更时往往要修改数据存储模型、修改复杂的查询脚本，图数据库已经把业务表达抽象好了 <a href="https://neo4j.com/developer/cypher-basics-i/" target="_blank" rel="noopener noreferrer">https://neo4j.com/developer/cypher-basics-i/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>教程 <a href="https://neo4j.com/developer/get-started/?_ga=2.244301506.635077318.1589298327-5599999.1589298327" target="_blank" rel="noopener noreferrer">https://neo4j.com/developer/get-started/?_ga=2.244301506.635077318.1589298327-5599999.1589298327<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>sandbox <a href="https://sandbox.neo4j.com/?ref=hcard" target="_blank" rel="noopener noreferrer">https://sandbox.neo4j.com/?ref=hcard<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>浏览器对url编码：适用于统一资源标识符(URI)的编码，也用于为&quot;application/x-www-form-urlencoded&quot; MIME准备数据， 因为它用于通过HTTP的请求操作(request)提交HTML表单数据</p> <p>RFC1738</p> <p>它将编码为<code>%20</code>而不是<code>+</code></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>unquote_plus解码
quote编码
旧版的编码urlencode
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>oss跨域</p> <p><img src="https://oscimg.oschina.net/oscnet/1573034604674-3e1c642d-e761-4e90-a0c9-d9b0c03c207f.png" alt="image.png"></p> <p>页面直接img显示的图片，而img并不会触发跨域，所以当页面打开后img会请求到CDN的图片并缓存到本地，而缓存不带CORS配置，然后ajax请求直接访问本地图片，触发了同源限制，导致跨域报错</p> <h2 id="算法-2"><a href="#算法-2" class="header-anchor">#</a> 算法</h2> <h2 id="apt"><a href="#apt" class="header-anchor">#</a> apt</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>sed -i &quot;s@http://deb.debian.org@http://mirrors.aliyun.com@g&quot; /etc/apt/sources.list
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="flask-2"><a href="#flask-2" class="header-anchor">#</a> flask</h2> <p>端点的规范URL 带有斜杠。它类似于文件系统中的文件夹。如果您访问的URL不带斜杠，Flask会将您重定向到带斜杠的规范URL</p> <p>不带斜杠。它类似于文件的路径名。使用斜杠访问URL会产生404“未找到”错误。这有助于使这些资源的URL保持唯一，从而有助于搜索引擎避免对同一页面进行两次索引</p> <p><a href="https://flask.palletsprojects.com/en/1.1.x/api/#flask.Flask.test_request_context" target="_blank" rel="noopener noreferrer"><code>test_request_context()</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 上下文管理器，告诉Flask即使在使用Python shell的情况下也表现得好像在处理请求一样</p> <p>Flask如何仍然保持线程安全</p> <h5 id="request"><a href="#request" class="header-anchor">#</a> request</h5> <p>method</p> <p>form</p> <p>args</p> <p>cookies</p> <h5 id="covid"><a href="#covid" class="header-anchor">#</a> covid</h5> <div class="language- line-numbers-mode"><pre class="language-text"><code>set FLASK_APP=flaskr
flask run
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>sqlalchemy</p> <p>mongodb</p> <p>flask-admin</p> <p>中文支持</p> <p>filter</p> <p>project layout</p> <h5 id="路由优先级"><a href="#路由优先级" class="header-anchor">#</a> 路由优先级</h5> <p>https://www.jianshu.com/p/6368b281d866</p> <p>为了获得更高的性能，让路径匹配得更快，优先匹配路由中变量较少的，接着根据权重。另外，静态路径权重 <code>&gt;</code> 动态路径权重，同样地会先匹配更短的路径；转换器 <code>converter</code> 也会影响权重，权重从高到低为：数字转换器 <code>-&gt;</code> 基于字符串的转换器 <code>-&gt;</code> 其他转换</p> <p>flask路由控制 https://jin-yang.github.io/post/flask-route.html</p> <h2 id="mongo"><a href="#mongo" class="header-anchor">#</a> mongo</h2> <ul><li><strong>admin</strong>： 从权限的角度来看，这是&quot;root&quot;数据库。要是将一个用户添加到这个数据库，这个用户自动继承所有数据库的权限。一些特定的服务器端命令也只能从这个数据库运行，比如列出所有的数据库或者关闭服务器。</li> <li><strong>local:</strong> 这个数据永远不会被复制，可以用来存储限于本地单台服务器的任意集合</li> <li><strong>config</strong>: 当Mongo用于分片设置时，config数据库在内部使用，用于保存分片的相关信息。</li></ul> <h2 id="apscheduler"><a href="#apscheduler" class="header-anchor">#</a> apscheduler</h2> <p>触发器（triggers）：触发器包含调度逻辑，描述一个任务何时被触发，按日期或按时间间隔或按 cronjob 表达式三种方式触发。每个作业都有它自己的触发器，除了初始配置之外，触发器是完全无状态的。</p> <p>作业存储器（job stores）：作业存储器指定了作业被存放的位置，默认情况下作业保存在内存，也可将作业保存在各种数据库中，当作业被存放在数据库中时，它会被序列化，当被重新加载时会反序列化。作业存储器充当保存、加载、更新和查找作业的中间商。在调度器之间不能共享作业存储。</p> <p>执行器（executors）：执行器是将指定的作业（调用函数）提交到线程池或进程池中运行，当任务完成时，执行器通知调度器触发相应的事件。</p> <p>调度器（schedulers）：任务调度器，属于控制角色，通过它配置作业存储器、执行器和触发器，添加、修改和删除任务。调度器协调触发器、作业存储器、执行器的运行，通常只有一个调度程序运行在应用程序中，开发人员通常不需要直接处理作业存储器、执行器或触发器，配置作业存储器和执行器是通过调度器来完成</p> <h4 id="数字图像处理-2"><a href="#数字图像处理-2" class="header-anchor">#</a> 数字图像处理</h4> <p>客观题30题 选择10 填空10 判断10 简答5题</p> <p>客观题 70分 简答题 50分 卷面满分120</p> <h4 id="通信原理"><a href="#通信原理" class="header-anchor">#</a> 通信原理</h4> <p>NIO</p> <p>epoll</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>socket=&gt;3
bind(3, 8090)
listen(3)
epoll_create() = 7
epoll_ctl(7,ADD,3,accept)
epoll_wait(3) O(1)阻塞的
accept(3)=8
epoll_ctl(7,ADD,8,read)
epoll_wait(3,8)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="提炼项目工作"><a href="#提炼项目工作" class="header-anchor">#</a> 提炼项目工作</h2> <p>为什么要这么做？</p> <p>其他人怎么做？</p> <p>效果如何？</p> <p>网络架构、项目管理、基础知识</p> <p>Big Memory = Optane + Memory Machine</p> <p>分布式</p> <p>MemVerge</p> <p>Optane</p> <h2 id="k8s"><a href="#k8s" class="header-anchor">#</a> k8s</h2> <h5 id="基础知识学习"><a href="#基础知识学习" class="header-anchor">#</a> 基础知识学习</h5> <p>微信读书搜索kubernetes</p> <h5 id="简单实践"><a href="#简单实践" class="header-anchor">#</a> 简单实践</h5> <p>https://harishnarayanan.org/writing/kubernetes-django/</p> <p>SessionAffinity：基于客户端IP地址进行会话保持的模式，即第1次将某个客户端发起的请求转发到后端的某个Pod上，之后从相同的客户端发起的请求都将被转发到后端相同的Pod上。</p> <h5 id="并发不够"><a href="#并发不够" class="header-anchor">#</a> 并发不够</h5> <p>资源隔离不良</p> <p>gunicorn抢占了资源</p> <p>gunicorn停掉多线程</p> <p>去掉Nginx</p> <p>gunicorn配置证书</p> <p>load balance</p> <p>如何debug</p> <h5 id="q-k8s-pod-一直pending"><a href="#q-k8s-pod-一直pending" class="header-anchor">#</a> Q:k8s pod 一直pending</h5> <p>Debugging Pods<a href="https://kubernetes.io/zh/docs/tasks/debug-application-cluster/debug-application/#debugging-pods" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>调试pod的第一步是看一下这个pod的信息，用如下命令查看一下pod的当前状态和最近的事件：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ kubectl describe pods <span class="token variable">${POD_NAME}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h5 id="q-1-node-s-had-taints-that-the-pod-didn-t-tolerate"><a href="#q-1-node-s-had-taints-that-the-pod-didn-t-tolerate" class="header-anchor">#</a> Q:1 node(s) had taints that the pod didn't tolerate.</h5> <p>出于安全考虑Pod不会被调度到Master Node上，也就是说Master Node不参与工作负载</p> <p>允许master节点部署pod</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ kubectl taint nodes --all node-role.kubernetes.io/master-
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="论文"><a href="#论文" class="header-anchor">#</a> 论文</h2> <h4 id="分布式图数据库geabase"><a href="#分布式图数据库geabase" class="header-anchor">#</a> 分布式图数据库GeaBase</h4> <p>图属性模型</p> <p>键值对结构</p> <p>新的技术</p> <p>*<strong>计算靠近存储*</strong>、**<em>双队列更新流水线*<strong>和</strong><em>用户粘性*</em></em></p> <p>***Gremlin*<strong>或</strong><em>SparQL*<strong>这样的</strong><em>标准图查询语言*</em></em></p> <p>GeaBase由四大模块构成：高可用（HA）模块、查询引擎、更新模块和图存储</p> <p>每一个GeoBase集群都保存了一份图数据的完整拷贝，因而也被命名为*<strong>GeaBase副本*</strong>（GeaBase Replica）</p> <p><strong>A. 图存储</strong></p> <p>1）数据模型</p> <p>OLP 描述对象链接属性</p> <p>图模式 Graph Schema</p> <p>节点类型列表</p> <p>边类型列表</p> <p>2）存储模型</p> <p>节点</p> <p>单键值对</p> <p>有向边</p> <p>双键值对</p> <p>给定源节点ID，出边则可视为*<strong>正向索引*</strong>（Forward Index），用于搜索到达目标节点的轨迹（这种情况可称之为*<strong>出边导航*</strong>，*<strong>out-edge-navigation*</strong>）。当给定目标节点，入边则可视为*<strong>反向索引*</strong>（Reverse Index），用于搜索到达源节点的轨迹（这种情况可称之为*<strong>入边导航*</strong>，*<strong>in-edge-navigation*</strong>）。</p> <p>仅在一种边上存储属性</p> <p>3）分片策略</p> <p>基于哈希</p> <p>根据键的前8个字节进行分区</p> <p>源节点和出边出现在相同分区</p> <h5 id="b-ha高可用模块"><a href="#b-ha高可用模块" class="header-anchor">#</a> B.HA高可用模块</h5> <h5 id=""><a href="#" class="header-anchor">#</a> <img src="https://pic1.zhimg.com/80/v2-3fd84a3fb8cc4f4ae56bc2536948c098_720w.jpg" alt="img"></h5> <h5 id="c-更新模块"><a href="#c-更新模块" class="header-anchor">#</a> C.更新模块</h5> <p>1）实时更新</p> <p>同步模式</p> <p>更新事件转换为查询字符串</p> <p>异步模式</p> <p>更新事件转换为消息放入队列中</p> <p>*<strong>一个GeaBase副本被选为更新中心*</strong>，它负责*<strong>集中消费*</strong> 多个消息队列（存储用户侧生产的消息）中的消息，我们把这个消费多个消息队列的更新中心称为*<strong>Master队列*</strong></p> <p><img src="https://pic4.zhimg.com/80/v2-435dde6b1ee4606f7ea0958ea25fd8fb_720w.jpg" alt="img"></p> <p>2）批量更新</p> <p>从数据仓库中导入离线计算的结果</p> <p><img src="https://pic2.zhimg.com/80/v2-4033f2f679e324d9a8f53039107d5885_720w.jpg" alt="img"></p> <h5 id="d-查询引擎"><a href="#d-查询引擎" class="header-anchor">#</a> D.查询引擎</h5> <p>1）引擎结构</p> <p>*<strong>计算靠近存储*</strong></p> <p>当geabase服务器收到查询请求时，它检查查询语句的语法正确性，然后生成与查询语义对应的遍历和计算计划。当查询需要非本地数据时，查询引擎生成一个子查询，该子查询检索远程数据，并通过内部请求将子查询发送到目标节点所在的服务器</p> <p>2）查询语言</p> <ol><li>图CRUD操作</li> <li>遍历与计算</li> <li>分析</li> <li>内建（build-in）函数：自定义UDF</li></ol> <div class="language- line-numbers-mode"><pre class="language-text"><code>( operator [:ATTR=value ])*
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>[:ATTR=value]可以是子查询</p> <p>3）Nav算子</p> <p>类似SQL语言中的SELECT语句，Nav(igation) 是GeaBase查询语言中是最常用的算子。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>(Nav [:START= | :DATA=] 
     [:EDGE_TYPE= | :REG_EDGE_TYPE=]
     [:DEPTH=][:FILTER=][:RETURN=]
     [...]
)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="ns-3-web-based-user-interface-power-grid-communications-planning-and-modeling-tool"><a href="#ns-3-web-based-user-interface-power-grid-communications-planning-and-modeling-tool" class="header-anchor">#</a> ns-3 Web-Based User Interface - Power Grid Communications Planning and Modeling Tool</h4> <p>ns- -3 3 基于 b Web 的用户界面- - 电网通信规划和建模
工具</p> <h4 id="_1-介绍"><a href="#_1-介绍" class="header-anchor">#</a> 1.介绍</h4> <p>PGCPMT 旨在为 ns-3 提供图形用户界面（GUI）前端，并支持
对智能电网用例的分析</p> <h4 id="_2-相关工作"><a href="#_2-相关工作" class="header-anchor">#</a> 2.相关工作</h4> <h5 id="a-core"><a href="#a-core" class="header-anchor">#</a> A.CORE</h5> <p>是控制虚拟机和网络仿真子系统的通用开放式研究仿真
器</p> <p>核心 GUI 工具可用于创建网络拓扑图</p> <p>仿真网络可以在一台或多台计算机上，并且可以连接
到实时网络</p> <p>核心 GUI 工具可用于创建网络拓扑图</p> <h5 id="b-radio-mobile-rm"><a href="#b-radio-mobile-rm" class="header-anchor">#</a> B.Radio Mobile（RM）</h5> <p>[2-3]是一种免费软件工具，可以通过使
用数字地形高程数据来预测无线电系统的性能</p> <p>创建其网络拓扑的图形视图创建其网络拓扑的图形视图</p> <h5 id="c-网络实验编程接口-nepi-4"><a href="#c-网络实验编程接口-nepi-4" class="header-anchor">#</a> C.网络实验编程接口（NEPI）[4]</h5> <p>是一种实验生命周期管理工具，
用于通过 PlanetLab 和与 ns-3 无缝集成的仿真节点进行异构
实验</p> <p>使用 NEPI 的两种方式是网络实验前端
（NEF）GUI 或 python 脚本。NEF 允许在画布中拖放和互连框。
复杂的实验也可以设计和执行为单个 python 脚本</p> <h4 id="_3-工具概述"><a href="#_3-工具概述" class="header-anchor">#</a> 3.工具概述</h4> <p>将 ns-3 网络模拟器与 GUI 集成在
一起是一项巨大的工作</p> <p>svg-edit 是一个
基于 Web 的开源基于 JavaScript 的 SVG 绘图编辑器，可在浏
览器中使用</p> <p>PGCPMT 应用程序是在 OMF 框架内构建的，并通过新的 GUI，
ns-3 代码生成器和对 ns-3 模拟器的访问来扩展 OMF</p> <p>OMF 使用 D3 JavaScript 库来生成动态的，交互式的数据可
视化。任何支持 D3 的浏览器（例如 Chrome 或其他浏览器）
都可以用于运行 OMF 和 PGCPMT</p> <p>ns-3 代码生成器使用 XSD（XML 模式定义）来指定如何正式
描述可扩展标记语言（XML）文档中的元素。提供给 ns-3 代
码生成器的 XML 文档描述了网络拓扑，所请求的网络仿真的
操作参数以及最终用户进行分析所需的输出结果。ns-3 代码
生成器是爱达荷州国家实验室（INL）ns-3 拓扑生成器工具
的增强版本，该工具最初由斯特拉斯堡大学的 Pierre Weiss
和 Sebastien Vincent 编写</p> <h5 id="_5-pgcpmt-的实现"><a href="#_5-pgcpmt-的实现" class="header-anchor">#</a> 5.pgcpmt 的实现</h5> <h6 id="_5-1登录"><a href="#_5-1登录" class="header-anchor">#</a> 5.1登录</h6> <p>5.2电力系统建模界面</p> <p>OMF 利用 GridLAB-D，一种配电系统仿真和分析工具，供设计
和操作配电系统的用户使用。GridLAB-D 模拟电源系统中许
多设备的相互依存行为</p> <p>PGCPMT</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>omf
python3.6
https://www.cnblogs.com/kimyeee/p/7250560.html

virtualenv -p /usr/local/python3.6/bin/python3.6 venv


ModuleNotFoundError: No module named '_bz2'

https://stackoverflow.com/questions/22346269/bz2-is-module-not-available-when-installing-pandas-with-pip-in-python-virtual
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="分享"><a href="#分享" class="header-anchor">#</a> 分享</h2> <p><a href="/pages/folder1/f:\down\我的坚果云\我的坚果云\bugfix\后台\docker结合烟草项目的分享.html">docker结合烟草项目的分享</a></p> <h2 id="web-v-2"><a href="#web-v-2" class="header-anchor">#</a> web-v</h2> <p>论文需要改进的地方</p> <p>1加强对对方论文的研究</p> <p>2参考更多的论文</p> <p>3论文的贡献，创新点在哪</p> <p>4需要更多的学术创新，现在的论文更像是一篇应用的实现</p> <p>5需要增加数学模型，相关方程</p> <p>6论文语法问题</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ns-3的调用可以优化

学下下svg编辑器svg-edit
代码生成器
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><a href="/pages/folder1/f:\down\我的坚果云\我的坚果云\bugfix\后台\web-v会议纪要7.11.html">web-v会议纪要7.11</a></p> <h4 id="web-v会议纪要7-11"><a href="#web-v会议纪要7-11" class="header-anchor">#</a> web-v会议纪要7.11</h4> <p>1）引言</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>加入
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>2）相关工作</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>更加详细，更多论文
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3）4.3去掉优化</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>优化前后的文字放入系统架构中
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>4）图片</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>fig1大图拆分为
web UI
manager node 包含 wait queue
run(ns-3) node
精简大图
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>图2、3需要优化 图2整合进入图1，左半边去掉，右边文字直接加入fig1
图7、8 数据还在，需要重新绘图
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>5）学术创新</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>对标平台，easyHPC,电网PGCPDM，802.1.11vh
1教程（教学功能） 2轻量级，简洁，简单使用，服务 3提供参考代码 4性能 并发 同等条件、开销更小、服务更多的用户，命令行，对流量的要求小 下载文件到本地，方便使用

我们的学术贡献：将一下学术创新，放在介绍里
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>6）其他</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>数学模型和相关方程 搁置

扩写3.2.2 写清楚的部署
docker-compose

现在是通过容器实现了多进程，考虑能否使用多线程，使编译的工作翻倍

安全性 
限制文件的大小 恶意病毒的文件比较大 len&lt;=10000
硬编码

前景
可扩展性：提出的新的后台方案，1使用redis实现，2分布式集群（图1、图3、图7、图8需要修改，需要重新做实验）
用户使用自己的服务器
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>队列</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>一个任务为一个事件，任务遍历容器列表，判断是否有空闲容器，若有，发送请求给run node执行，若无，任务进入等待队列

manager容器收到run容器的返回值后，调用回调函数，从等待队列里取任务进入运行队列然后执行

同一时间只能有3个request
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><img src="C:%5CUsers%5Czengdewei1%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200710210640429.png" alt="image-20200710210640429"></p> <p><img src="https://pic3.zhimg.com/80/v2-3fd84a3fb8cc4f4ae56bc2536948c098_720w.jpg" alt="img"></p> <p>PPT</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>以解题报告PPT为基础
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="rust"><a href="#rust" class="header-anchor">#</a> Rust</h2> <h3 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>export RUSTUP_DIST_SERVER=https://mirrors.ustc.edu.cn/rust-static
export RUSTUP_UPDATE_ROOT=https://mirrors.ustc.edu.cn/rust-static/rustup
curl https://sh.rustup.rs -sSf | sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="windows加速"><a href="#windows加速" class="header-anchor">#</a> windows加速</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>#用于更新 toolchain

set RUSTUP_DIST_SERVER=https://mirrors.ustc.edu.cn/rust-static

#用于更新 rustup

set RUSTUP_UPDATE_ROOT=https://mirrors.ustc.edu.cn/rust-static/rustup
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="卸载"><a href="#卸载" class="header-anchor">#</a> 卸载</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>rustup self uninstall
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="国内镜像加速"><a href="#国内镜像加速" class="header-anchor">#</a> 国内镜像加速</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code># 放到 `$HOME/.cargo/config` 文件中
[source.crates-io]
registry = &quot;https://github.com/rust-lang/crates.io-index&quot;

# 替换成你偏好的镜像源
replace-with = 'ustc'

# 中国科学技术大学
[source.ustc]
registry = &quot;git://mirrors.ustc.edu.cn/crates.io-index&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h5 id="bash配置"><a href="#bash配置" class="header-anchor">#</a> bash配置</h5> <div class="language- line-numbers-mode"><pre class="language-text"><code>在~/.bashrc文件末尾添加如下：
export PATH=$PATH:/root/.cargo/bin(待添加路径)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="语法"><a href="#语法" class="header-anchor">#</a> 语法</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>数据类型
函数
包装箱和模块
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>缺少CL/cl.h</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>opencl-headers
ocl-icd-libopencl
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="git-2"><a href="#git-2" class="header-anchor">#</a> git</h2> <p>template</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>https://gitee.com/zengdewei1/django_template
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="不止代码"><a href="#不止代码" class="header-anchor">#</a> 不止代码</h2> <p>以 java 为例，大部分业务代码就是 if-else 加个数据库操作，但我们完全可以
自己学些更多 java 的知识，例如垃圾回收，调优，网络编程等，这些可能暂时没用，
但真要用的时候，不是 google 一下就可以了，这个时候谁已经掌握了相关知识和技
能，机会就是谁的</p> <p>重复代码太多，是否可以引入设计模式？
系统性能一般，可否进行优化？
目前是单机，如果做成双机是否更好？
版本开发质量不高，是否引入高效的单元测试和集成测试方案？
目前的系统太庞大，是否可以通过重构和解耦改为 3 个系统？
阿里中间件有一些系统感觉我们也可以用，是否可以引入 ？</p> <p>自己动手丰衣足食”，也就是自己去尝试搭建一些模拟环境，自己写一些测试程序</p> <p>Jvm 垃圾回收：可以自己写一个简单的测试程序，分配内存不释放，然后调整
各种 jvm 启动参数，再运行的过程中使用 jstack、jstat 等命令查看 jvm 的堆
内存分布和垃圾回收情况。这样的程序写起来很简单，简单一点的就几行，复
杂一点的也就几十行</p> <p>Reactor 原理：自己真正去尝试写一个 Reactor 模式的 Demo，不要以为这
个很难，最简单的 Reactor 模式代码量（包括注释）不超过 200 行（可以参考
Doug Lee 的 PPT）。自己写完后，再去看看 netty 怎么做，一对比理解就更
加深刻了</p> <p>框架封装了 DAL 层：可以自己用 JDBC 尝试去写一个分库分表的简单实现，
然后与框架的实现进行对比，看看差异在哪里</p> <p>用浏览器的工具查看 HTTP 缓存实现，看看不同种类的网站，不同类型的资
源，具体是如何控制缓存的；也可以自己用 Python 写一个简单的 HTTP 服务
器，模拟返回各种 HTTP Headers 来观察浏览器的反应</p> <h2 id="嵌入式"><a href="#嵌入式" class="header-anchor">#</a> 嵌入式</h2> <h3 id="usart-串口通信"><a href="#usart-串口通信" class="header-anchor">#</a> USART-串口通信</h3> <p>数据包</p> <p>起始位、主体数据、校验位、停止位</p> <p>1、比特率</p> <p>异步时需要比特率一致，以便解码</p> <p>2、数据校验</p> <p>奇、偶校验</p> <p>USART在STM32中的应用最多莫过于“打印”程序信息</p> <h2 id="教程资源"><a href="#教程资源" class="header-anchor">#</a> 教程资源</h2> <p><a href="https://proto.school" target="_blank" rel="noopener noreferrer">关于分布式Web 协议的交互式教程<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">lastUpdate:</span> <span class="time">9/9/2020, 3:55:07 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/pages/folder1/工作.html" class="prev">
        面经
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.53968dc3.js" defer></script><script src="/assets/js/2.f9c1d4bc.js" defer></script><script src="/assets/js/10.96fa90b8.js" defer></script>
  </body>
</html>
